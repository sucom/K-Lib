/** @license K-Lib | (c) Kumararaja <sucom.kumar@gmail.com> | License (MIT) */
function _fnRequired(e,t){var a=klib.getElValue(e);return _showValidateMsg(e,t,!klib.isBlank(a))}function _fnValidDigits(e,t){var a=$(e).val(),n=0===a.length||/^\d+$/.test(a);return _showValidateMsg(e,t,n)}function _fnValidNumbers(e,t){var a=$(e).val(),n=0===a.length||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a);return _showValidateMsg(e,t,n)}function _fnValidInteger(e,t){var a=$(e).val(),n=0===a.length||/^-?\d+$/.test(a);return _showValidateMsg(e,t,n)}function _fnValidAlpha(e,t){var a=$(e).val(),n=0===a.length||!/[^a-z]/gi.test(a);return _showValidateMsg(e,t,n)}function _fnValidAlphaNumeric(e,t){var a=$(e).val(),n=0===a.length||!/[^a-z0-9]/gi.test(a);return _showValidateMsg(e,t,n)}function _fnValidPatternMatch(e,t){var a=$(e).val(),n=0===a.length;if(!n){var i=new RegExp($(e).data("validatePattern"),$(e).data("validatePatternOptions").replace(/!/g,""));n=i.test(a),$(e).data("validatePatternOptions").indexOf("!")>=0&&(n=!n)}return _showValidateMsg(e,t,n)}function _fnValidValueRange(e,t){var a=$(e).val(),n=0===a.length;if(!n&&(n=!1,/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a))){var i=klib.toFloat(a),l=(" "+($(e).data("validateRange")||"")+": ").split(":"),o=!klib.isBlank(l[0]),r=!klib.isBlank(l[1]),s=klib.toFloat(l[0]),d=klib.toFloat(l[1]);o&&r?n=i>=s&&d>=i:o?n=i>=s:r&&(n=d>=i)}return _showValidateMsg(e,t,n)}function _fnValidLengthMin(e,t){var a=$(e).val(),n=klib.toInt($(e).attr("minlength")),i=a.length>=n;return _showValidateMsg(e,t,i)}function _fnValidLengthMax(e,t){var a=$(e).val(),n=klib.toInt($(e).attr("maxlength")),i=a.length<=n;return _showValidateMsg(e,t,i)}function _fnValidLengths(e,t){var a=$(e).val(),n=a.length,i=klib.toInt($(e).attr("minlength")),l=klib.toInt($(e).attr("maxlength")),o=n>=i&&l>=n;return _showValidateMsg(e,t,o)}function _fnValidWordSize(e,t){var a=$(e).val(),n=_.max(_.map((""+a).replace(/[-\n]/g," ").split(" "),function(e){return e.length})),i=klib.toInt($(e).data("validWordSize"))||20,l=i>=n;return _showValidateMsg(e,t,l)}function _fnValidEmail(e,t){var a=$(e).val(),n=0===a.length;return n||(n=(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)||/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/i.test(a))&&/[a-z0-9]/i.test(a[a.length-1])),_showValidateMsg(e,t,n)}function _fnValidUrl(e,t){var a=$(e).val(),n=0===a.length;return n||(n=/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)),_showValidateMsg(e,t,n)}function _isValidDate(e,t){var a=$(e).val(),n=0===a.length;if(!n){n=!1;var i,l,o,r=["","JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],s=["","JANUARY","FEBRUARY","MARCH","APRIL","MAY","JUNE","JULY","AUGUST","SEPTEMBER","OCTOBER","NOVEMBER","DECEMBER"],d=$(e).data("validateFormat")||"YMD",c="^\\d{1,2}[\\/\\-\\.]\\d{1,2}[\\/\\-\\.]\\d{4}$",u=a.replace(/[^a-z]/gi,"");if(u){var p=_.indexOf(r,u.toUpperCase());0>=p&&(p=_.indexOf(s,u.toUpperCase())),p>0&&(a=a.replace(new RegExp(u,"gi"),p))}a=a.replace(/[^0-9]/g," ").normalizeStr().replace(/ /g,"/");var k=a.split("/");switch(d.toUpperCase()){case"YMD":c="^\\d{4}[\\/\\-\\.]\\d{1,2}[\\/\\-\\.]\\d{1,2}$",i=k[0],l=k[1],o=k[2];break;case"MDY":l=k[0],o=k[1],i=k[2];break;case"DMY":o=k[0],l=k[1],i=k[2]}if(new RegExp(c,"").test(a)){o=parseInt(o,10),l=parseInt(l,10),i=parseInt(i,10);var f=new Date(i,l-1,o);n=f.getFullYear()===i&&f.getMonth()===l-1&&f.getDate()===o}}return _showValidateMsg(e,t,n)}function _fnValidCardNo(e,t){var a=$(e).val(),n=0===a.length;if(!n)if(/[^0-9 \-]+/.test(a))n=!1;else{for(var i=0,l=0,o=!1,r=a.replace(/\D/g,""),s=r.length-1;s>=0;s--){var d=r.charAt(s);l=parseInt(d,10),o&&(l*=2)>9&&(l-=9),i+=l,o=!o}n=i%10===0}return _showValidateMsg(e,t,n)}function _fnValidIpv4(e,t){var a=$(e).val(),n=0===a.length;n||(n=/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$/i.test(a)&&_.every(a.split("."),function(e){return e.length>1?!e.beginsWith("0"):!0})),_showValidateMsg(e,t,n)}function _fnValidIpv6(e,t){var a=$(e).val(),n=0===a.length;n||(n=/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i.test(a)),_showValidateMsg(e,t,n)}function _fnValidIpAddress(e,t){var a=$(e).val(),n=0===a.length;if(!n){var i=a,l=klib.toInt($(e).data("validateIpaddressOctates")||4)-1,o=new RegExp("^(([01]?[0-9]?[0-9]|2([0-4][0-9]|5[0-5]))\\.){"+l+"}([01]?[0-9]?[0-9]|2([0-4][0-9]|5[0-5]))$","g");n=o.test(i)&&_.every(i.split("."),function(e){return e.length>1?!e.beginsWith("0"):!0}),_showValidateMsg(e,t,n);var r=$(e).data("validateIpaddressClass");if(n&&r){var s=i.split("."),d={A:{oct1:{B:0,E:127},oct2:{B:0,E:256},oct3:{B:0,E:256},oct4:{B:1,E:255}},B:{oct1:{B:127,E:192},oct2:{B:1,E:256},oct3:{B:0,E:256},oct4:{B:0,E:255}},C:{oct1:{B:191,E:224},oct2:{B:0,E:256},oct3:{B:1,E:256},oct4:{B:1,E:255}},D:{oct1:{B:223,E:240},oct2:{B:0,E:256},oct3:{B:0,E:256},oct4:{B:0,E:256}},E:{oct1:{B:239,E:255},oct2:{B:0,E:256},oct3:{B:0,E:256},oct4:{B:0,E:255}}};n=1*s[0]>d[r].oct1.B&&1*s[0]<d[r].oct1.E&&1*s[1]>=d[r].oct2.B&&1*s[1]<d[r].oct2.E&&1*s[2]>=d[r].oct3.B&&1*s[2]<d[r].oct3.E&&1*s[3]>d[r].oct4.B&&1*s[3]<d[r].oct4.E?!0:!1,_showValidateMsg(e,t,n)}}return n}function _fnValidSubnet(e,t){var a=$(e).val(),n=0===a.length;if(!n){var i=new RegExp("^((128|192|224|240|248|252|254)\\.0\\.0\\.0)|(255\\.(((0|128|192|224|240|248|252|254)\\.0\\.0)|(255\\.(((0|128|192|224|240|248|252|254)\\.0)|255\\.(0|128|192|224|240|248|252|254)))))$");n=i.test(a)&&_.every(a.split("."),function(e){return e.length>1?!e.beginsWith("0"):!0})}return _showValidateMsg(e,t,n)}function _fnValidPhoneUS(e,t){var a=$(e).val(),n=0===a.length;return n||(n=a.length>9&&a.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)),_showValidateMsg(e,t,n)}function _showValidateMsg(e,t,a,n){t=t||"",arguments.length>2&&_.isString(a)&&(n=a),arguments.length>2&&_.isBoolean(a)&&a&&(t=""),n=n||_validateAlertTemplate,e=$($(e).data("validateMsgEl")||e).get(0);var i=$(e).next(),l="";if($(i).attr("class")===$(n).attr("class")){if(t.beginsWith("i18n:","i")){var o=t.replace(/i18n:/gi,"");l="{html:'"+o+"'}",t=$.i18n.prop(o)}_isOnOfflineValidation||($(i).data("i18n",l),$(i).html(t))}else klib.isBlank(t)||($(n).insertAfter($(e)),_showValidateMsg(e,t,a,n));return a}function _clearValidateMsg(e){return _showValidateMsg(e),!0}!function(){for(var e,t=function(){},a=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],n=a.length,i=window.console=window.console||{};n--;)e=a[n],i[e]||(i[e]=t);"none"in window||(window.none=""),"noop"in window||(window.noop=function(){})}();var isKHashRouteOn=!1;!function(){function __renderView(e,t){var a,n=klib.setElIdIfNot(e);return a=t&&!$.isEmptyObject(t)?klib.render("#"+n,t):klib.render("#"+n)}var win=this,klib=function(e){return e instanceof klib?e:this instanceof klib?void 0:new klib(e)};win.klib=klib,klib.VERSION="2.0.0";var isById=document.getElementById,isByName=document.all;klib.isIE=isByName?!0:!1,klib.isNonIE=isById&&!isByName?!0:!1,klib.noop=function(){},klib.debug=!1,klib["debugger"]={on:function(){klib.debug=!0},off:function(){klib.debug=!1},toggle:function(){klib.debug=!klib.debug}},klib.cOut=function(e,t){klib.debug&&console[e]&&console[e](t)},klib.console={clear:function(){console.clear()},assert:function(e){klib.cOut("assert",e)},count:function(e){klib.cOut("count",e)},debug:function(e){klib.cOut("debug",e)},dir:function(e){klib.cOut("dir",e)},dirxml:function(e){klib.cOut("dirxml",e)},error:function(e){klib.cOut("error",e)},exception:function(e){klib.cOut("exception",e)},group:function(e){klib.cOut("group",e)},groupCollapsed:function(e){klib.cOut("groupCollapsed",e)},groupEnd:function(e){klib.cOut("groupEnd",e)},info:function(e){klib.cOut("info",e)},log:function(e){klib.cOut("log",e)},markTimeline:function(e){klib.cOut("markTimeline",e)},profile:function(e){klib.cOut("profile",e)},profileEnd:function(e){klib.cOut("profileEnd",e)},table:function(e){klib.cOut("table",e)},time:function(e){klib.cOut("time",e)},timeEnd:function(e){klib.cOut("timeEnd",e)},timeStamp:function(e){klib.cOut("timeStamp",e)},trace:function(e){klib.cOut("trace",e)},warn:function(e){klib.cOut("warn",e)}},klib._initWindowOnHashChange=function(){"onhashchange"in window&&(isKHashRouteOn=!0,klib.console.info("Registering HashRouting Listener"),window.onhashchange=function(e){var t=window.location.hash;klib.console.info("onHashChange: "+t),t?klib.route(t):klib.routesOptions.defaultPageRoute&&klib.route(klib.routesOptions.defaultPageRoute)})},klib._stopWindowOnHashChange=function(){window.onhashchange=void 0},String.trim||(String.prototype.trim=function(e){return e=e||"\\s+",this.replace(new RegExp("^"+e+"|"+e+"$","g"),"")}),String.trimLeft||(String.prototype.trimLeft=function(e){return this.replace(new RegExp("^"+(e||"\\s+"),"g"),"")}),String.trimRight||(String.prototype.trimRight=function(e){return this.replace(new RegExp((e||"\\s+")+"$","g"),"")}),String.isBlank||(String.prototype.isBlank=function(){return""==this.trim()}),String.ifBlank||(String.prototype.ifBlank=function(e){return e=e||"",this.isBlank()?(""+e).trim():this.trim()}),String.isNumber||(String.prototype.isNumber=function(){return 0==(""+this).replace(/[0-9.]/g,"").trim().length}),String.normalizeStr||(String.prototype.normalizeStr=function(){return this.trim().replace(/\s+/g," ")}),String.beginsWith||(String.prototype.beginsWith=function(e,t){t=t?"i":"";var a=new RegExp("^"+e,t);return this.normalizeStr().match(a)?!0:!1}),String.beginsWithIgnoreCase||(String.prototype.beginsWithIgnoreCase=function(e){var t=new RegExp("^"+e,"i");return this.normalizeStr().match(t)?!0:!1}),String.endsWith||(String.prototype.endsWith=function(e,t){t=t?"gi":"g";var a=new RegExp(e+"$",t);return this.normalizeStr().match(a)?!0:!1}),String.endsWithIgnoreCase||(String.prototype.endsWithIgnoreCase=function(e,t){var a=new RegExp(e+"$","gi");return this.normalizeStr().match(a)?!0:!1}),String.contains||(String.prototype.contains=function(e,t){t=t?"gi":"g";var a=new RegExp(""+e,t);return a.test(this)}),String.equals||(String.prototype.equals=function(e){return this==e}),String.equalsIgnoreCase||(String.prototype.equalsIgnoreCase=function(e){return String(this.toLowerCase())==String(e).toLowerCase()}),String.toProperCase||(String.prototype.toProperCase=function(e){return("undefined"==typeof e||e?this.normalizeStr():this).toLowerCase().replace(/^(.)|\s(.)/g,function(e){return e.toUpperCase()})}),klib.toJSON=function(str){var thisStr;return _.isString(str)&&(thisStr=str.trim(),thisStr.contains(":")&&!thisStr.contains(",")&&thisStr.contains(";")&&(thisStr=thisStr.replace(/\;/g,",")),thisStr.beginsWith("{")||thisStr.beginsWith("\\[")?thisStr.beginsWith("{")&&!thisStr.contains(":")&&thisStr.contains("=")&&(thisStr=""+thisStr.replace(/=/g,":")):thisStr=thisStr.contains(":")?"{"+thisStr+"}":thisStr.contains("=")?"{"+thisStr.replace(/=/g,":")+"}":"["+thisStr+"]"),!_.isString(str)&&_.isObject(str)?str:klib.isBlank(str)?null:eval("("+thisStr+")")},String.toJSON||(String.prototype.toJSON=function(){return klib.toJSON(this)}),String.toBoolean||(String.prototype.toBoolean=function(){var e=!0;switch((""+this).trim().toLowerCase()){case"":case"0":case"-0":case"nan":case"null":case"false":case"undefined":e=!1}return e&&(e=!(""+this).trim().beginsWith("-")),e}),Boolean.toValue||(Boolean.prototype.toValue=function(e,t){return"undefined"==typeof e&&(e=!0),"undefined"==typeof t&&(t=!1),this.valueOf()?e:t}),Boolean.toHtml||(Boolean.prototype.toHtml=function(e,t){return $(this.valueOf()?e:t).html()}),String.pad||(String.prototype.pad=function(e,t,a){for(var n="",i=0;e>i;i++)n+=t;return(0===a||2===a?n:"")+this+(1===a||2===a?n:"")}),klib.lastSplitResult=[],klib.getOnSplit=function(e,t,a){return klib.lastSplitResult=e.split(t),klib.getOnLastSplit(a)},klib.getOnLastSplit=function(e){return 0>e?_.last(klib.lastSplitResult):klib.lastSplitResult[e]},klib.isBlank=klib.isEmpty=function(e){var t=!0;if(e)switch(!0){case _.isString(e):t=0==e.trim().length;break;case _.isArray(e):case _.isObject(e):t=_.isEmpty(e)}return t},klib.isNumber=function(e){return 0==(""+e).replace(/[0-9.]/g,"").trim().length},klib.toBoolean=function(e){var t=!0;switch((""+e).trim().toLowerCase()){case"":case"0":case"-0":case"nan":case"null":case"false":case"undefined":t=!1}return t},klib.toInt=function(e){return e=(""+e).replace(/[^+-0123456789.]/g,""),e=klib.isBlank(e)?"0":e.indexOf(".")>=0?e.substring(0,e.indexOf(".")):e,parseInt(1*e,10)},klib.toFloat=function(e){return e=(""+e).replace(/[^+-0123456789.]/g,""),e=klib.isBlank(e)?"0":e,parseFloat(1*e)},klib.toStr=function(e){var t=""+e;return _.isObject(e)&&(t=JSON.stringify(e)),t},klib.dotToX=function(e,t){return e.replace(/\./g,t)},klib.dotToCamelCase=function(e){var t=e.replace(/\./g," ").toProperCase().replace(/ /g,"");return t[0].toLowerCase()+t.substring(1)},klib.dotToTitleCase=function(e){return e.replace(/\./g," ").toProperCase().replace(/ /g,"")},klib.toDottedPath=function(e){return(e||"").replace(/]/g,"").replace(/(\[)|(\\)|(\/)/g,".").replace(/(\.+)/g,".").trim("\\.")},klib.ifBlank=klib.ifEmpty=klib.ifNull=function(e,t){return t=(""+(t||"")).trim(),klib.isBlank(e)?t:(""+e).trim()},klib.now=function(){return""+(new Date).getTime()},klib.year=function(e){return e=e||0,(new Date).getFullYear()+klib.toInt(e)},klib.range=function(e){var t=e.toUpperCase().split(".."),a=""+t[0],n=""+t[1],i="1";n.indexOf(":")>0&&(n=""+t[1].split(":")[0],i=""+t[1].split(":")[1]),a.indexOf("Y")>=0&&(a=klib.year(a.split(/[^0-9+-]/)[1])),n.indexOf("Y")>=0&&(n=klib.year(n.split(/[^0-9+-]/)[1]));var l=klib.toInt(a),o=klib.toInt(n),r=klib.toInt(i);return a>n?_.range(o,l+1,r).reverse():_.range(l,o+1,r)},klib.checkAndPreventKey=function(e,t){t||(t="");var a=t.indexOf("+shift")>=0,n=""+e.keyCode,i=t.pad(1,",",2).indexOf(n.pad(1,",",2))>=0&&(a?e.shiftKey?!0:!1:e.shiftKey?!1:!0);return i&&(e.preventDefault(),klib.console.info("Key ["+n+(a?"+Shift":"")+"] has been disabled in this element.")),i},klib._trackAndControlKey=function(e){var t=e.currentTarget,a=(""+$(t).data("disableKeys")).toLowerCase();klib.checkAndPreventKey(e,a);var n=!klib.isBlank((""+$(t).data("focusNext")).replace(/undefined/,"").toLowerCase()),i=!klib.isBlank((""+$(t).data("focusBack")).replace(/undefined/,"").toLowerCase());n&&klib.checkAndPreventKey(e,"9")&&$($(t).data("focusNext")).get(0).focus(),i&&klib.checkAndPreventKey(e,"9,+shift")&&$($(t).data("focusBack")).get(0).focus()},klib.initKeyTracking=function(){var e=arguments.length?arguments[0]:"[data-disable-keys],[data-focus-next],[data-focus-back]";klib.console.info("Finding Key-Tracking for element(s): "+e),$(e).each(function(e,t){$(t).keydown(klib._trackAndControlKey),klib.console.info("kLib is tracking keys on element:"),klib.console.info(t)})},klib.getDocObj=function(e){var t="object"==typeof e?e:(e.beginsWith("#")?"":"#")+e;return $(t).get(0)},klib.getDocObjs=function(e){var t=(e.beginsWith("#")?"":"#")+e;return $(t).get()},klib.setFocus=function(e,t){var a=klib.getDocObj(e);a&&(a.focus(),t&&a.select())},klib.isElementExist=function(e){return!$.isEmptyObject($(e).get())},klib.swapObjClass=function(e,t,a){$(e).removeClass(t),$(e).addClass(a)},klib.docObjValue=function(e,t){var a=klib.getDocObj(e),n="";return a&&(n=a.value,2===arguments.length&&(a.value=t)),n},klib.optionSelectedIndex=function(e,t){var a=-1,n=klib.getDocObj(e);return n&&(a=n.selectedIndex,2===arguments.length&&(n.selectedIndex=t)),a},klib.optionIndexOfValue=function(e,t){var a=-1,n=klib.getDocObj(e);if(n)for(var i=0;i<n.length;i++)if((""+t).equalsIgnoreCase(n.options[i].value)){a=i;break}return a},klib.optionIndexOfText=function(e,t){var a=-1,n=klib.getDocObj(e);if(n)for(var i=0;i<n.length;i++)if(t.equalsIgnoreCase(n.options[i].text)){a=i;break}return a},klib.optionIndexOfValueBeginsWith=function(e,t){var a=-1,n=klib.getDocObj(e);if(n)for(var i=0;i<n.length;i++)if(n.options[i].value.beginsWith(t,"i")){a=i;break}return a},klib.optionsSelectedValues=function(e,t){return e=(e.beginsWith("#")?"":"#")+e,t=t||",",$.map($(e+" option:selected"),function(e){return e.value}).join(t)},klib.optionsSelectedTexts=function(e,t){return e=(e.beginsWith("#")?"":"#")+e,t=t||",",$.map($(e+" option:selected"),function(e){return e.text}).join(t)},klib.optionValueOfIndex=function(e,t){var a="",n=klib.getDocObj(e);return n&&t>=0&&t<n.length&&(a=n.options[t].value),a},klib.optionTextOfIndex=function(e,t){var a="",n=klib.getDocObj(e);return n&&t>=0&&t<n.length&&(a=n.options[t].text),a},klib.selectOptionForValue=function(e,t){var a=-1,n=klib.getDocObj(e);return n&&(a=klib.optionIndexOfValue(e,t),n.selectedIndex=a),a},klib.selectOptionForValueBeginsWith=function(e,t){var a=-1,n=klib.getDocObj(e);return n&&(a=klib.optionIndexOfValueBeginsWith(e,t),n.selectedIndex=a),a},klib.selectOptionsForValues=function(e,t,a){a=a||",",t=(a+t+a).toLowerCase();var n,i=klib.getDocObj(e);if(i)for(var l=0;l<i.length;l++)n=(a+i.options[l].value+a).toLowerCase(),i.options[l].selected=t.indexOf(n)>=0},klib.selectOptionForText=function(e,t){var a=-1,n=klib.getDocObj(e);return n&&(a=klib.optionIndexOfText(e,t),n.selectedIndex=a),a},klib.selectOptionsAll=function(e){var t=klib.getDocObj(e);if(t)for(var a=0;a<t.length;a++)t.options[a].selected=!0},klib.selectOptionsNone=function(e){var t=klib.getDocObj(e);if(t)for(var a=0;a<t.length;a++)t.options[a].selected=!1},klib.optionsReduceToLength=function(e,t){t=t||0;var a=klib.getDocObj(e);a&&(klib.selectOptionsNone(e),a.length=t)},klib.optionsRemoveAll=function(e){klib.optionsReduceToLength(e,0)},klib.optionRemoveForIndex=function(e,t){e=(e.beginsWith("#")?"":"#")+e;var a=klib.getDocObj(e);a&&((""+t).equalsIgnoreCase("first")&&(t=0),(""+t).equalsIgnoreCase("last")&&(t=a.length-1),a.remove(t))},klib.optionRemoveForValue=function(e,t){klib.optionRemoveForIndex(e,klib.optionIndexOfValue(e,t))},klib.optionRemoveForText=function(e,t){klib.optionRemoveForIndex(e,klib.optionIndexOfText(e,t))},klib.optionRemoveForValueBeginsWith=function(e,t){klib.optionRemoveForIndex(e,klib.optionIndexOfValueBeginsWith(e,t))},klib.optionAppend=function(e,t,a,n){var i=-1,l=klib.getDocObj(e);if(l)if("undefined"==typeof n){var o=l.length;l.length=o+1,l.options[o].value=t,l.options[o].text=a,i=o}else $(l).find("option").eq(n).before('<option value="'+t+'">'+a+"</option>"),i=n;return i},klib.optionsLoad=function(e,t,a,n){var i=["","key","value"];if(a=a||0,n=n||0,_.isString(t)&&t.indexOf("..")>0&&(t=klib.range(t)),a>=0&&klib.optionsReduceToLength(e,a),_.isArray(t))_.each(t,function(t){klib.optionAppend(e,t,t)});else if(n>0){var l=[];for(var o in t)l.push({key:o,value:t[o]});var r=_.sortBy(l,i[n]);_.each(r,function(t){klib.optionAppend(e,t.key,t.value)})}else _.each(t,function(t,a){klib.optionAppend(e,a,t)})},klib.checkedState=function(e,t){var a=!1,n=klib.getDocObj(e);return n&&(a=n.checked,2===arguments.length&&(n.checked=t)),a},klib.isChecked=function(e,t){return $("input[name="+t+"]:checked",e).length>0},klib.radioSelectedValue=function(e,t){var a=$("input[name="+t+"]:checked",e).val();return a?a:""},klib.radioClearSelection=function(e,t){$("input[name="+t+"]:checked",e).attr("checked",!1)},klib.radioSelectForValue=function(e,t,a){$("input[name="+t+"]:radio",e).each(function(e){e.checked=e.value.equalsIgnoreCase(a)})},klib.checkboxCheckedValues=function(e,t,a){return a=a||",",$("input[name="+t+"]:checked",e).map(function(){return this.value}).get().join(a)},klib.sleep=function(e){var t=new Date;for(t.setTime(t.getTime()+1e3*e);(new Date).getTime()<t.getTime(););},klib.filterJSON=function(e,t){return $(e).filter(function(e,a){for(var n in t)if(!a[n].toString().match(t[n]))return null;return a})},klib.randomPassword=function(e){for(var t="9a8b77C8D9E8F7G6H5I4J3c6d5e4f32L3M4N5P6Qg2h3i4j5kV6W5X4Y3Z26m7n8p9q8r7s6t5u4v3w2x3y4z5A6BK7R8S9T8U7",a="",n=0;e>n;n++){var i=Math.floor(Math.random()*t.length);a+=t.charAt(i)}return a},klib.rand=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},klib.htmlEncode=function(e){return $("<div/>").text(e).html()},klib.htmlDecode=function(e){return $("<div/>").html(e).text()},klib.parseKeyStr=function(e,t){return(t?e.toLowerCase():e).replace(/[^_0-9A-Za-z]/g,"")},klib.setObjProperty=function(e,t,a,n){t=""+t,n=n||!1;var i,l=e,o=t.split(/(?=[A-Z])/),r=$.trim(t.replace(/[0-9A-Za-z]/g,""));for(r&&""!=r&&(o=t.split(r[0]));o.length>1;)i=klib.parseKeyStr(o.shift(),n),""!=$.trim(i)&&("undefined"==typeof l[i]&&(l[i]={}),l=l[i]);return i=klib.parseKeyStr(o.shift(),n),l[i]=a,e},klib.getElValue=function(e){e=$(e).get(0);var t,a;switch(e.tagName.toUpperCase()){case"INPUT":switch(e.type.toLowerCase()){case"checkbox":a=$(e).data("unchecked"),t=e.checked?e.value:"undefined"==typeof a?"":a;break;case"radio":t=e.checked?e.value:"";break;default:t=$(e).val()}break;case"SELECT":t=$.map($(e).find("option:selected"),function(e){return e.value}).join(",");break;case"TEXTAREA":t=$(e).val();break;default:t=$(e).html()}return t},klib.serializeDisabled=function(e){var t="";return $(e).find("[disabled][name]").each(function(){t+=(t?"&":"")+$(this).attr("name")+"="+klib.getElValue(this)}),t},klib.serializeForms=function(e,t){var a,n,i=$(e).serialize();return $(e).find("input:checkbox:enabled:not(:checked)[name]").each(function(){n=$(this).data("unchecked"),i+=(i?"&":"")+$(this).attr("name")+"="+("undefined"==typeof n?"":n)}),t&&(a=klib.serializeDisabled(e),i+=(i&&a?"&":"")+a),i},klib.queryStringToJson=function(e){var t={},a=e||location.search,n=(""+a).indexOf("?"),i=(""+a).indexOf("&");return a&&a.length>0&&n>=0&&(0==n||i>n)&&(a=a.substring(n+1)),_.each(a.split("&"),function(e){e=e.split("="),e[0]&&(_.has(t,e[0])?(_.isArray(t[e[0]])||(t[e[0]]=[t[e[0]]]),t[e[0]].push(decodeURIComponent(e[1]||""))):t[e[0]]=decodeURIComponent(e[1]||""))}),t},$.fn.serializeUncheckedCheckboxes=function(e){var t,a,n,i,l="object"==typeof e,o=l?e:{},r=l&&!e?"":e;return $(this).find("input:checkbox:enabled:not(:checked)[name]").each(function(e,s){t=$(s),n=t.attr("name"),a=t.data("unchecked"),i="undefined"==typeof a?"":a,l?_.has(o,n)?(_.isArray(o[n])||(o[n]=[o[n]]),o[n].push(i)):o[n]=i:r+=(r?"&":"")+n+"="+i}),l?o:r},klib.serializeUncheckedCheckboxes=function(e,t){return $(e).serializeUncheckedCheckboxes(t)},$.fn.serializeFormToJSON=$.fn.serializeFormToObject=function(e,t,a){var n,i,l=this.serializeArray(),o="object"==typeof e?e:{},r="boolean"==typeof e?e:t||!1,s=$(this).data("serializeIgnorePrefix");return a&&(s=a),$.each(l,function(){n=s?this.name.replace(s,""):this.name,o=klib.setObjProperty(o,n,this.value,r)}),$(this).find("input:checkbox:enabled:not(:checked)").each(function(){n=$(this).attr("name"),n&&(i=$(this).data("unchecked"),s&&(n=n.replace(s,"")),i=""+("undefined"==typeof i?"":i),o=klib.setObjProperty(o,n,i,r))}),o},$.fn.serializeFormToSimpleJSON=$.fn.serializeFormToSimpleObject=function(e,t){var a,n,i,l,o=this.serializeArray(),r="object"==typeof e?e:{},s="boolean"==typeof e?e:t||!1;return $.each(o,function(){r[this.name]=this.value}),s&&$(this).find("[disabled][name]").each(function(){r[this.name]=klib.getElValue(this)}),$(this).find("input:checkbox:enabled:not(:checked)[name]").each(function(){i=$(this).attr("name"),l=$(this).data("unchecked"),l=""+("undefined"==typeof l?"":l),r[i]=l}),$(this).find("[data-to-json-group][name]").each(function(){a=this.name,n=$(this).data("toJsonGroup"),n&&(r[n]||(r[n]={}),r[n][a]=klib.getElValue(this))}),r},klib.serializeFormToSimpleJSON=klib.serializeFormToSimpleObject=function(e,t,a){return $(e).serializeFormToSimpleJSON(t,a)},klib.serializeFormToJSON=klib.serializeFormToObject=function(e,t,a,n){return $(e).serializeFormToJSON(t,a,n)},klib.find=klib.locate=function(obj,path){var tObj=obj,retValue;return"undefined"!=typeof eval("tObj."+path)&&(retValue=eval("tObj."+path)),retValue},klib.findSafe=klib.locateSafe=klib.valueOfKeyPath=function(e,t,a){for(var n=0,i=klib.toDottedPath(t).split("."),l=i.length;l>n;n++){if(!e||"undefined"==typeof e)return a;e=e[i[n]]}return"undefined"==typeof e?a:e},klib.has=klib.hasKey=function(obj,path){var tObj=obj;return"undefined"!=typeof eval("tObj."+path)},klib.hasIgnoreCase=klib.hasKeyIgnoreCase=function(e,t){var a="",n=e||{},i=""+klib.toDottedPath(t),l=klib.keysDottedAll(n);return l&&!_.isEmpty(l)&&(klib.console.debug(l),_.some(l,function(e){var t=e.equalsIgnoreCase(i);return t||(t=e.beginsWithIgnoreCase(i+"."),t&&(e=e.slice(0,e.lastIndexOf(".")))),t&&(a=e),t})),a},klib.findIgnoreCase=function(e,t,a){var n=a,i=klib.hasIgnoreCase(e,t);return i&&(n=klib.findSafe(e,i,a)),n},klib.keysDottedAll=function(e){var t=klib.keysDotted(e);return t&&!_.isEmpty(t)&&(t=klib.toDottedPath(t.join(",")).split(",")),t},klib.keysDotted=function(e){e=e||{};var t,a,n,i=[];return function(e,l){if(l=l||"","object"!=typeof e)return!0;for(var o in e)n=l.substring(1),t=klib.isNumber(o)?"[":".",a=n&&"["==t?"]":"",arguments.callee(e[o],l+t+o+a)&&i.push(n+(n?t:"")+o+a);return!1}(e),i},klib.keysCamelCase=function(e){return _.map(klib.keysDotted(e),function(e){var t=e.replace(/\./g," ").toProperCase().replace(/ /g,"");return t[0].toLowerCase()+t.substring(1)})},klib.keysTitleCase=function(e){return _.map(klib.keysDotted(e),function(e){return e.replace(/\./g," ").toProperCase().replace(/ /g,"")})},klib.keys_=function(e){return _.map(klib.keysDotted(e),function(e){return e.replace(/\./g,"_")})},$.cachedScript=function(e,t){return t=$.extend(t||{},{dataType:"script",cache:!0,url:e}),klib.console.info("$.cachedScript('"+e+"')"),$.ajax(t)},$.cachedStyle=function(e,t,a){return a=$.extend(a||{},{dataType:"text",cache:!0,url:t,success:function(t){$("head").append("<style id='"+e+"' type='text/css'>"+t+"</style>")}}),klib.console.info("$.cachedScript('"+t+"')"),$.ajax(a)},klib.addScript=function(e,t){e=e.replace(/#/,""),klib.console.group("kAddScript"),klib.isElementExist("#kScriptsCotainer")||(klib.console.info("#kScriptsCotainer NOT Found! Creating one..."),$("body").append("<div id='kScriptsCotainer' style='display:none' rel='Dynamic Scripts Container'></div>")),klib.isElementExist("#"+e)?klib.console.info("script ["+e+"] already found in local."):(klib.console.info("script ["+e+"] NOT found. Added script tag with src ["+t+"]"),$("#kScriptsCotainer").append("<script id='"+e+"' type='text/javascript' src='"+t+"'></script>")),klib.console.groupEnd("kAddScript")},klib.addStyle=function(e,t){e=e.replace(/#/,""),klib.console.group("kAddStyle"),klib.isElementExist("#kStylesCotainer")||(klib.console.info("#kStylesCotainer NOT Found! Creating one..."),$("body").append("<div id='kStylesCotainer' style='display:none' rel='Dynamic Styles Container'></div>")),klib.isElementExist("#"+e)?klib.console.info("style ["+e+"] already found in local."):(klib.console.info("style ["+e+"] NOT found. Added link tag with href ["+t+"]"),$("#kStylesCotainer").append("<link id='"+e+"' rel='stylesheet' type='text/css' href='"+t+"'/>")),klib.console.groupEnd("kAddStyle")},klib.loadScript=function(e,t,a,n){return e=e.replace(/#/,""),a=a||!1,n=n||[],klib.console.group("kScriptsLoad"),klib.isBlank(t)?klib.console.error("script path ["+t+"] for ["+e+"] NOT defined."):a?klib.addScript(e,t):n.push($.cachedScript(t).done(function(a,n){klib.console.info("Loaded script ["+e+"] from ["+t+"]. STATUS: "+n)})),klib.console.groupEnd("kScriptsLoad"),n},klib.loadStyle=function(e,t,a,n){return e=e.replace(/#/,""),a=a||!1,n=n||[],klib.console.group("kStylesLoad"),klib.isBlank(t)?klib.console.error("style path ["+t+"] for ["+e+"] NOT defined."):a?klib.addStyle(e,t):n.push($.cachedStyle(e,t).done(function(a,n){klib.console.info("Loaded style ["+e+"] from ["+t+"]. STATUS: "+n)})),klib.console.groupEnd("kStylesLoad"),n},klib.addTemplateScript=function(e,t,a){e=e.replace(/#/,""),klib.isElementExist("#kViewTemplateCotainer")||(klib.console.info("#kViewTemplateCotainer NOT Found! Creating one..."),$("body").append("<div id='kViewTemplateCotainer' style='display:none' rel='Template Container'></div>")),klib.console.info("Adding <script id='"+e+"' type='text/"+a+"'>"),$("#kViewTemplateCotainer").append("<script id='"+e+"' type='text/"+a+"'>"+t+"</script>")},klib.loadTemplate=function(e,t,a,n,i,l){if(e=e.replace(/#/g,""),t=t.ifBlank("inline").trim(),a=a||"x-template",n=n||"#DummyInlineTemplateContainer",i=i||[],klib.console.group("kTemplateAjaxQue"),klib.isElementExist("#"+e)){var o=$("#"+e);if(l)klib.console.warn("Reload Template["+e+"] of ["+a+"]"),o.remove(),i=klib.loadTemplate(e,t,a,n,i,l);else if(klib.isBlank(o.html())){klib.console.warn("Template["+e+"] of ["+a+"] script found EMPTY!");var r=""+o.attr("path");klib.isBlank(r)||(a=(o.attr("type")||"").ifBlank(a).toLowerCase().replace(/text\//gi,""),klib.console.info("prepare/remove to re-load Template["+e+"]  of ["+a+"] from external path: ["+r+"]"),o.remove(),i=klib.loadTemplate(e,r,a,n,i,l))}else klib.console.info("Template["+e+"]  of ["+a+"] already found in local.")}else if(klib.console.info("Template["+e+"] of ["+a+"] NOT found. Source ["+t+"]"),t.equalsIgnoreCase("inline")||t.beginsWith("#")){var s=t.equalsIgnoreCase("inline")?n:t,d=$(s),c=d.html();klib.isBlank(c)?klib.console.error("Template["+e+"] of ["+a+"] NOT defined inline in ["+s+"]."):(klib.addTemplateScript(e,c,a),
t.equalsIgnoreCase("inline")&&d.html(""))}else if(t.equalsIgnoreCase("none"))klib.console.warn("Template["+e+"] of ["+a+"] defined as NONE. Ignoring template.");else if(t.equalsIgnoreCase("script"))klib.console.error("Template["+e+"] of ["+a+"] NOT defined in <script>.");else{var u;l?(klib.console.warn(">>>>>>>>>> Making New Template Request"),u=$.ajax({url:t,cache:!1,dataType:"html",success:function(n){klib.addTemplateScript(e,n,a),klib.console.info("Loaded Template["+e+"] of ["+a+"] from ["+t+"]")},error:function(n,i,l){klib.console.error("Failed Loading Template["+e+"] of ["+a+"] from ["+t+"]. ["+i+":"+l+"]")}})):u=$.get(t,function(n){klib.addTemplateScript(e,n,a),klib.console.info("Loaded Template["+e+"] of ["+a+"] from ["+t+"]")}),i.push(u)}return klib.console.groupEnd("kTemplateAjaxQue"),i},klib.loadTemplatesCollection=function(e,t){e=(e.beginsWith("#")?"":"#")+e;var a={};return klib.isElementExist(e)?klib.console.info(e+" Found! skip template collection load from "+t):(klib.console.info(e+" NOT Found! Creating one..."),klib.isElementExist("#kViewTemplateCotainer")||(klib.console.info("#kViewTemplateCotainer NOT Found! Creating one..."),$("body").append("<div id='kViewTemplateCotainer' style='display:none' rel='Template Container'></div>")),$("#kViewTemplateCotainer").append("<div id='"+e.substring(1)+"' style='display:none' rel='Template Collection Container'></div>"),$.ajax({url:t,cache:!0,dataType:"html",async:!1,success:function(n){$(e).html(n),klib.console.info("Loaded Template Collection ["+e+"] from ["+t+"]"),klib.console.info("Found following templates in Template Collection."),$(e+" script").each(function(e,t){a[$(t).attr("id")]="script"}),klib.console.info({o:a})},error:function(a,n,i){klib.console.error("Failed Loading Template Collection ["+e+"] from ["+t+"]. ["+n+":"+i+"]")}})),a},klib.urlParams=function(e){e=e||window.location.search||"",e=e.beginsWith("\\?")||e.indexOf("//")<7?e.substr(e.indexOf("?")+1):e;var t={};return e.replace(/([^&=]+)=?([^&]*)(?:&+|$)/g,function(e,a,n){(t[a]=t[a]||[]).push(decodeURIComponent(n))}),_.each(t,function(e,a){t[a]=_.isArray(e)&&1==e.length?e[0]:e}),t},klib.urlParam=function(e,t){return klib.urlParams(t)[e]},klib.getLocHash=function(){return window.location.hash||""},klib.urlHash=function(e,t){var a=(klib.getLocHash()||"#").substring(1);if(e){t=t||"/",a=a.beginsWith(t)?a.substring(a.indexOf(t)+t.length):a;var n=a.split(t);_.isNumber(e)?a=n&&n.length>e?n[e]:"":_.isArray(e)?a=0===e.length?n:_.object(e,n):_.isString(e)&&"?"==e&&(a=a.contains("\\?")?klib.getOnSplit(a,"?",1):"")}return a},klib.hashParam=function(e){var t=""+klib.urlHash("?");return"undefined"==typeof e||klib.isBlank(t)||(t=klib.urlParam(""+e,t)),t},klib.routeMatch=function(e,t){var a=new RegExp(":[a-zA-Z0-9\\_\\-]+","g"),n=new RegExp(e.replace(a,"([\\w\\+\\-\\|\\.\\?]+)")),i=e.match(a),l=t.match(n),o=l&&!_.isEmpty(l)?l.shift():"",r=i&&!_.isEmpty(i)?i.join(",").replace(/:/g,"").split(","):[],l=l&&!_.isEmpty(l)?l.join(",").replace(/\?/g,"").split(","):[],s=void 0;return o&&(s={hkeys:i,params:_.zipObject(r,l)}),s},klib.i18n={},klib.i18n.loaded=!1,klib.i18n.settings={name:"Language",path:"language/",encoding:"UTF-8",cache:!0,mode:"map",callback:null},klib.i18n.setLanguage=function(e,t){$.i18n&&(e=e||$.i18n.browserLang().replace(/-/g,"_"),t=$.extend(klib.i18n.settings,t),$.i18n.properties({name:t.name,language:e,path:t.path,encoding:t.encoding,cache:t.cache,mode:t.mode,callback:function(){$.i18n.loaded="undefined"==typeof $.i18n.loaded?!$.isEmptyObject($.i18n.map):$.i18n.loaded,klib.i18n.loaded=klib.i18n.loaded||$.i18n.loaded,e.length>1&&!$.i18n.loaded&&(klib.console.warn("Error Loading Language File ["+e+"]. Loading default."),klib.i18n.setLanguage("_",t)),klib.i18n.apply(),t.callback&&t.callback($.i18n.loaded)}}))},klib.i18n.text=function(e,t){var a=$.i18n.prop(e);if(t){var n="";_.each(_.keys(t),function(e){n=""+t[e],n&&n.beginsWith("i18n:","i")&&(n=$.i18n.prop(n.replace(/i18n:/gi,""))),a=a.replace(new RegExp("{"+e+"}","gi"),n)})}return a},klib.i18n.apply=klib.i18n.render=function(e,t){klib.i18n.loaded&&(e=e||"body",t=t||"",$(t+"[data-i18n]",e).each(function(e,t){var a=klib.toJSON($(t).data("i18n")||"{}"),n=a.i18ndata;n&&delete a.i18ndata,a&&!$.isEmptyObject(a)&&_.each(_.keys(a),function(e){var i=a[e],l=klib.i18n.text(i,n);_.each(e.split("_"),function(e){switch(e.toLowerCase()){case"html":$(t).html(l);break;case"text":$(t).text(l);break;default:$(t).attr(e,l)}})})}))},klib.extendBackbone=function(){window.Backbone?(klib.console.info("Found Backbone. Extending ..."),_.extend(Backbone.Model.prototype,Backbone.Events,{activeCRUD:"",diffAttributes:function(e){return window.jsondiffpatch?jsondiffpatch.diff(this.previousAttributes(),this.toJSON(),e):this.changedAttributes()},sync:function(){return this.activeCRUD=arguments[0],Backbone.sync.apply(this,arguments)},url:function(){var e,t,a,n,i,l=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();if(l)for(n="object"==typeof l?l:{defaulturl:l},n.patch=n.patch||n.update,e=_.result(n,this.activeCRUD.toLowerCase()+"url")||_.result(n,"defaulturl")||urlError(),t=e.replace(/\{crud\}/gi,this.activeCRUD.toUpperCase()).replace(/\{now\}/gi,klib.now())+(this.isNew()||e.indexOf("?")>0?"":("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id));(a=t.match(/{([\s\S]*?)}/g))&&a&&a[0];)i=a[0].replace(/[{}]/g,""),t=t.replace(new RegExp(a[0],"g"),(i.indexOf(".")>=0?klib.find(this.toJSON(),i):this.get(i))||"");return klib.console.info("Backbone Sync Url: "+t),t}})):klib.console.warn("Backbone not found. NOT extending...")},klib.loadBackboneModelClass=function(e,t){t||(t={});var a={url:e,bbclass:Backbone.Model.extend({defaults:{}}),success:!1};return $.ajax({url:a.url,dataType:"text",async:!1,success:function(e){e=e.substring(e.indexOf("{")),a.bbclass=Backbone.Model.extend(klib.toJSON(e)),a.success=!0,t.success&&t.success(e)},error:function(e,n,i){klib.console.error("Failed loading backbone class from ["+a.url+"]. ["+n+":"+i+"]"),t.fail&&t.fail(a.url,e,n,i)}}),a},klib.getModifiedElement=function(e){var t,a=void 0,n=$(e||"form:not([data-ignore-change]) :input:not(:disabled,:button,[data-ignore-change])");return _.every(n,function(e){return t||(e.tagName.match(/^(select|textarea)$/i)&&e.value!=e.defaultValue?t=!0:e.tagName.match(/^input$/i)&&(e.type.match(/^(checkbox|radio)$/i)&&e.checked!=e.defaultChecked?t=!0:e.type.match(/^(text|password|hidden|color|email|month|number|tel|time|url|range|date|datetime|datetime-local)$/i)&&e.value!=e.defaultValue&&(t=!0)),t&&(a=e)),!t}),a},klib.getModifiedElements=function(e){var t,a=[],n=$(e||"form:not([data-ignore-change]) :input:not(:disabled,:button,[data-ignore-change])");return n.each(function(e,n){t=!1,n.tagName.match(/^(select|textarea)$/i)&&n.value!=n.defaultValue?t=!0:n.tagName.match(/^input$/i)&&(n.type.match(/^(checkbox|radio)$/i)&&n.checked!=n.defaultChecked?t=!0:n.type.match(/^(text|password|hidden|color|email|month|number|tel|time|url|range|date|datetime|datetime-local)$/i)&&n.value!=n.defaultValue&&(t=!0)),t&&a.push(n)}),a},klib.initTrackElValueChanges=klib.resetElementsDefaultValue=function(e){$(e||"form :input:not(:disabled)").each(function(e,t){t.defaultValue=t.value,t.tagName.match(/^input$/i)&&t.type.match(/^(checkbox|radio)$/i)&&t.checked!=t.defaultChecked&&(t.defaultChecked=t.checked)})},klib.trash={container:[],push:function(e){this.container.push(e)},empty:function(){this.container=[]},pick:function(e){return e?this.container[e]:this.container}},klib.fillData=function(e,t,a){var n="object"==typeof e;t&&"object"==typeof t&&(a=t,t=null),t=t||"body";var i={dataParams:{},dataCache:!1,keyFormat:"aBc",selectPattern:"[name='?']",formatterCommon:null,formatterOnKeys:null,resetElDefault:!0,resetElDefaultInContext:!0,keysMap:{}};if($.extend(i,a),n||$.ajax({url:e,data:i.dataParams,cache:i.dataCache,dataType:"text",async:!1,success:function(t){e=klib.toJSON(t),n="object"==typeof e},error:function(t,a,n){klib.console.error("Failed loading data from ["+e+"]. ["+a+":"+n+"]")}}),n){var l=i.keyFormat;l=null!=l.match(/^[a-z]/)?"aBc":l,l=null!=l.match(/^[A-Z]/)?"AbC":l;var o=klib.keysDotted(e);klib.console.group("fillData"),klib.console.info(o),_.each(o,function(a){klib.console.group(">>"+a);var n=""+(a.replace(/[\[\]]/g,"_")||""),o=a.replace(/\[[0-9]+\]/g,""),r=/\[[0-9]+\]/.test(a);switch(l){case"_":n=klib.dotToX(n,"_"),o=klib.dotToX(o,"_");break;case"AbC":n=klib.dotToTitleCase(n),o=klib.dotToTitleCase(o);break;default:n=klib.dotToCamelCase(n),o=klib.dotToCamelCase(o)}var s={patternKey:n+(r?" || "+o:""),formatterKey:o,isArrayChild:r};klib.trash.push(s),klib.console.info(s),klib.trash.empty();var d=i.selectPattern.replace(/\?/g,n);(i.keysMap[n]||i.keysMap[o])&&(i.keysMap[n]=i.keysMap[n]||{},i.keysMap[o]=i.keysMap[o]||{},i.keysMap[n].pattern=i.keysMap[n].pattern||i.keysMap[o].pattern,i.keysMap[n].pattern&&(d=i.keysMap[n].pattern.replace(/\?/g,n)),i.keysMap[o].formatter&&(i.formatterOnKeys=i.formatterOnKeys||{},i.formatterOnKeys[o]=i.keysMap[o].formatter)),klib.console.info(">> "+d+" found: "+$(d,t).length);var c=null;$(d,t).length>0&&(c=klib.find(e,a),!i.formatterOnKeys&&i.formatterCommon&&(c=i.formatterCommon(c,a,e)),i.formatterOnKeys&&(i.formatterOnKeys[o]?c=i.formatterOnKeys[o](c,a,e):i.formatterCommon&&(c=i.formatterCommon(c,a,e))),klib.console.info({value:c})),$(d,t).each(function(e,t){switch(klib.console.info(t),t.tagName.toUpperCase()){case"INPUT":switch(t.type.toLowerCase()){case"text":case"password":case"hidden":case"color":case"date":case"datetime":case"datetime-local":case"email":case"month":case"number":case"search":case"tel":case"time":case"url":case"range":case"button":case"submit":case"reset":$(t).val(c),!i.resetElDefaultInContext&&i.resetElDefault&&(t.defaultValue=t.value);break;case"checkbox":case"radio":t.checked=t.value.equalsIgnoreCase(c),!i.resetElDefaultInContext&&i.resetElDefault&&(t.defaultChecked=t.checked)}break;case"SELECT":klib.selectOptionForValue(t,c),!i.resetElDefaultInContext&&i.resetElDefault&&(t.defaultValue=t.value);break;case"TEXTAREA":$(t).val(c),!i.resetElDefaultInContext&&i.resetElDefault&&(t.defaultValue=t.value);break;default:$(t).html(c)}}),klib.console.groupEnd(">>"+a)}),klib.console.groupEnd("fillData"),i.resetElDefaultInContext&&klib.resetElementsDefaultValue(t+" :input")}},klib.toRenderDataStructure=function(e,t){var a={},n={},i={},l={};switch(t&&(l=_.isString(t)?klib.queryStringToJson(t):_.isObject(t)?t:{}),!0){case _.isString(e):e.contains("\\|")&&(a.dataModel=klib.getOnSplit(e,"|",0),e=klib.getOnLastSplit(1)),a.dataUrl=e,_.isEmpty(l)||(a.dataParams=l);break;case _.isArray(e):n={urls:[]},i={},_.each(e,function(e,t){i={url:e,params:l},e.contains("\\|")&&(i.target=klib.getOnSplit(e,"|",0),i.url=klib.getOnLastSplit(1)),n.urls.push(i)});break;case _.isObject(e):n={urls:[]},i={},_.each(_.keys(e),function(t,a){i={name:t,url:e[t],params:l},e[t].contains("\\|")&&(i.target=klib.getOnSplit(e[t],"|",0),i.url=klib.getOnLastSplit(1)),n.urls.push(i)})}return _.isEmpty(n.urls)||(a.dataCollection=n),a},klib.viewModels={},klib.renderHistory={},klib.renderHistoryMax=0,klib.defaults={dataTemplateEngine:"handlebars"},klib.render=function(viewContainerId,uOptions){var retValue={id:"",view:{},model:{},cron:"",elDataAttr:{},iOptions:uOptions},kAjaxRequestsQue=[],foundViewContainer=klib.isElementExist(viewContainerId);foundViewContainer&&(retValue.elDataAttr=$(viewContainerId).data());var kDefaultTemplateConfig={backbone:{engine:"underscore",template:"x-underscore-template"},hogan:{engine:"hogan",template:"x-hogan-template"},unknown:{engine:"unknown",template:"x-unknown-template"}},noOfArgs=arguments.length,useOptions=noOfArgs>1,useParamData=useOptions&&uOptions.hasOwnProperty("data"),dataFound=!0,kRVOptions={data:{},dataUrl:"",dataUrlErrorHandle:"",dataParams:{},dataModel:"",dataModelType:"",dataCache:!1,dataCollection:{},dataTemplatesCollectionUrl:"",dataTemplates:{},dataTemplateEngine:"",dataTemplate:"",dataTemplatesCache:!0,dataScripts:{},dataScriptsCache:!0,dataStyles:{},dataStylesCache:!0,dataRenderEngine:"",dataRenderCallback:"",dataRenderId:""};if(foundViewContainer||(klib.isElementExist("#kRunTimeHtmlContainer")||$("body").append("<div id='kRunTimeLoadContainer' style='display:none;'></div>"),$("#kRunTimeLoadContainer").append("<div id='"+viewContainerId.replace(/\#/gi,"")+"'></div>")),useOptions){var saveOptions=uOptions.hasOwnProperty("saveOptions")&&uOptions.saveOptions;for(var key in uOptions)kRVOptions[key]=uOptions[key],saveOptions&&"data"!==key&&"saveOptions"!==key&&$(viewContainerId).data(""+(""+(_.at(""+key,4)||"")).toLowerCase()+key.slice(5),klib.toStr(uOptions[key]))}var kRenderId=(""+$(viewContainerId).data("renderId")).replace(/undefined/,"");klib.isBlank(kRVOptions.dataRenderId)||(kRenderId=kRVOptions.dataRenderId),retValue.id=kRenderId.ifBlank("kRender"+klib.now()+klib.rand(1e3,9999));var kRenderEngine=(""+$(viewContainerId).data("renderEngine")).replace(/undefined/,"");klib.isBlank(kRVOptions.dataRenderEngine)||(kRenderEngine=kRVOptions.dataRenderEngine),kRenderEngine=kRenderEngine.ifBlank("unknown").toLowerCase();var kRenderEngineKey=kRenderEngine;kDefaultTemplateConfig.hasOwnProperty(kRenderEngineKey)||(kRenderEngineKey="unknown",kRenderEngine+="-unknown");var kTemplateType=kDefaultTemplateConfig[kRenderEngineKey].template,kTemplateEngine=(""+$(viewContainerId).data("templateEngine")).replace(/undefined/,"");switch(klib.isBlank(kRVOptions.dataTemplateEngine)||(kTemplateEngine=kRVOptions.dataTemplateEngine),klib.isBlank(kTemplateEngine)&&(kTemplateEngine=kRenderEngineKey.equalsIgnoreCase("unknown")?klib.defaults.dataTemplateEngine||"handlebars":kTemplateEngine.ifBlank(kDefaultTemplateConfig[kRenderEngineKey].engine).toLowerCase()),kTemplateEngine){case"hogan":"unknown"==kRenderEngine&&(kRenderEngineKey=kRenderEngine=kTemplateEngine,kTemplateType=kDefaultTemplateConfig[kRenderEngineKey].template)}var kBackboneModelOption={},kViewDataModelType=(""+$(viewContainerId).data("modelType")).replace(/undefined/,"");if(klib.isBlank(kRVOptions.dataModelType)||(kViewDataModelType=kRVOptions.dataModelType),kViewDataModelType.beginsWith("backbone:","i")&&(kBackboneModelOption=klib.toJSON(kViewDataModelType.substring(9)),kViewDataModelType="backbone",kRenderEngine.equalsIgnoreCase("unknown")&&(kRenderEngine="backbone")),kViewDataModelType=kViewDataModelType.ifBlank().toLowerCase(),klib.console.group("kLoadingViewScripts"),useOptions&&uOptions.hasOwnProperty("dataScriptsCache"))klib.console.info("Override [data-scripts-cache] with user option [dataScriptsCache]: "+kRVOptions.dataScriptsCache);else{var scriptsCacheInTagData=(""+$(viewContainerId).data("scriptsCache")).replace(/undefined/,"");klib.isBlank(scriptsCacheInTagData)||(kRVOptions.dataScriptsCache=scriptsCacheInTagData.toBoolean(),klib.console.info("Override [data-scripts-cache] with [data-scripts-cache] option in tag-attribute: "+kRVOptions.dataScriptsCache))}var vScriptsList=(""+$(viewContainerId).data("scripts")).replace(/undefined/,"");vScriptsList&&klib.isBlank((vScriptsList||"").replace(/[^:'\"]/g,""))&&(vScriptsList="'"+vScriptsList.split(",").join("','")+"'");var vScripts=klib.toJSON(vScriptsList||"{}");if($.isEmptyObject(kRVOptions.dataScripts)||(vScripts=kRVOptions.dataScripts),_.isArray(vScripts)&&_.remove(vScripts,function(e){return!e}),klib.console.info(vScripts),vScripts&&!$.isEmptyObject(vScripts)){if(_.isArray(vScripts)){klib.console.info("Convert array of script(s) without scriptID to object with scriptID(s).");var newScriptsObj={},dynScriptIDForContainer="__scripts_"+viewContainerId.trim("#")+"_";_.each(vScripts,function(e,t){klib.console.log(e),e&&(newScriptsObj[dynScriptIDForContainer+t]=""+e)}),klib.console.info("Scripts(s) with scriptID(s)."),klib.console.log(newScriptsObj),vScripts=_.isEmpty(newScriptsObj)?{}:newScriptsObj}klib.console.info("External scripts to be loaded [cache:"+kRVOptions.dataScriptsCache+"] along with view container ["+viewContainerId+"] => "+JSON.stringify(vScripts));var vScriptsNames=_.keys(vScripts);klib.console.group("kLoadingScripts"),_.each(vScriptsNames,function(e){kAjaxRequestsQue=klib.loadScript(e,vScripts[e],kRVOptions.dataScriptsCache,kAjaxRequestsQue)}),klib.console.info("External Scripts Loading Status: "+JSON.stringify(kAjaxRequestsQue)),klib.console.groupEnd("kLoadingScripts")}else klib.console.info("No scripts defined [data-scripts] in view container ["+viewContainerId+"] to load.");klib.console.groupEnd("kLoadingViewScripts"),$.when.apply($,kAjaxRequestsQue).then(function(){klib.console.info("External Scripts Loaded.")}).fail(function(){klib.console.error("External Scripts Loading Failed! Unexpected!? Check the Script Path/Network.")}),klib.console.group("kDataModel");var dataModelName=(""+$(viewContainerId).data("model")).replace(/undefined/,""),viewDataModelName;klib.isBlank(kRVOptions.dataModel)||(dataModelName=kRVOptions.dataModel);var dataModelUrl=(""+$(viewContainerId).data("url")).replace(/undefined/,"");klib.isBlank(kRVOptions.dataUrl)||(dataModelUrl=kRVOptions.dataUrl);var isLocalDataModel=useParamData||dataModelUrl.beginsWith("local:","i"),defaultDataModelName=dataModelUrl.beginsWith("local:","i")?dataModelUrl.replace(/local:/gi,""):"data";dataModelName=dataModelName.ifBlank(defaultDataModelName),viewDataModelName=dataModelName.replace(/\./g,"_");var kTemplateModelData={};if(useParamData)kTemplateModelData[viewDataModelName]=kRVOptions.data,klib.console.info("Loaded data model ["+dataModelName+"] from argument");else{if(useOptions&&uOptions.hasOwnProperty("dataCache"))klib.console.info("Override [data-cache] with user option [dataCache]: "+kRVOptions.dataCache);else{var dataCacheInTagData=(""+$(viewContainerId).data("cache")).replace(/undefined/,"");klib.isBlank(dataCacheInTagData)||(kRVOptions.dataCache=dataCacheInTagData.toBoolean(),klib.console.info("Override [data-cache] with [data-cache] option in tag-attribute: "+kRVOptions.dataCache))}if(klib.isBlank(dataModelUrl)){kTemplateModelData[viewDataModelName]={};var dataModelCollection=(""+$(viewContainerId).data("collection")).replace(/undefined/,"");dataModelCollection&&(dataModelCollection=klib.toJSON(dataModelCollection)),klib.isBlank(kRVOptions.dataCollection)||(dataModelCollection=kRVOptions.dataCollection),_.isArray(dataModelCollection)&&(dataModelCollection={urls:dataModelCollection});var dataModelUrls=dataModelCollection.urls;if(klib.isBlank(dataModelUrls))klib.console.warn("Model Data ["+dataModelName+"] or [data-url] or [data-collection] NOT found! Check the arguments or html markup. Rendering with empty data {}.");else if(_.isArray(dataModelUrls)){klib.console.info("Processing data-URLs");var dataIndexApi=0,defaultAutoDataNamePrefix=dataModelCollection.nameprefix||"data";_.each(dataModelUrls,function(dataApi){var defaultApiDataModelName=defaultAutoDataNamePrefix+dataIndexApi,apiDataModelName=_.has(dataApi,"name")?(""+dataApi.name).replace(/[^a-zA-Z0-9]/gi,""):_.has(dataApi,"target")?""+dataApi.target:defaultApiDataModelName,apiDataUrl=_.has(dataApi,"url")?dataApi.url:_.has(dataApi,"path")?dataApi.path:"";apiDataModelName.contains(".")&&(apiDataModelName=_.last(apiDataModelName.split("."),1)),apiDataModelName=apiDataModelName.ifBlank(defaultApiDataModelName),klib.console.info("processing data-api for: "+apiDataModelName),klib.console.log(dataApi),apiDataUrl?kAjaxRequestsQue.push($.ajax({url:apiDataUrl,data:_.has(dataApi,"params")?dataApi.params:_.has(dataApi,"data")?dataApi.data:{},cache:_.has(dataApi,"cache")?dataApi.cache:kRVOptions.dataCache,dataType:"text",success:function(result){var targetApiData,targetDataModelName=_.has(dataApi,"target")?""+dataApi.target:"",oResult=(""+result).toJSON();targetApiData=targetDataModelName.indexOf(".")>0?klib.hasKey(oResult,targetDataModelName)?klib.find(oResult,targetDataModelName):oResult:oResult.hasOwnProperty(targetDataModelName)?oResult[targetDataModelName]:oResult,kTemplateModelData[viewDataModelName][apiDataModelName]?(kTemplateModelData[viewDataModelName][apiDataModelName]=[kTemplateModelData[viewDataModelName][apiDataModelName]],kTemplateModelData[viewDataModelName][apiDataModelName].push(targetApiData)):kTemplateModelData[viewDataModelName][apiDataModelName]=targetApiData,klib.console.info("Loaded data model ["+apiDataModelName+"] from ["+apiDataUrl+"]");var fnApiDataSuccess=dataApi.success||dataApi.onsuccess||dataApi.onSuccess;fnApiDataSuccess||(fnApiDataSuccess=dataModelCollection.success||dataModelCollection.onsuccess||dataModelCollection.onSuccess),fnApiDataSuccess&&(_.isFunction(fnApiDataSuccess)?fnApiDataSuccess(oResult,dataApi):_.isString(fnApiDataSuccess)&&eval("("+fnApiDataSuccess+"(oResult, dataApi))"))},error:function(jqXHR,textStatus,errorThrown){klib.console.warn("Error processing data-api ["+apiDataUrl+"]");var fnOnApiDataUrlErrorHandle=dataApi.error||dataApi.onerror||dataApi.onError;fnOnApiDataUrlErrorHandle||(fnOnApiDataUrlErrorHandle=dataModelCollection.error||dataModelCollection.onerror||dataModelCollection.onError,fnOnApiDataUrlErrorHandle||klib.isBlank(kRVOptions.dataUrlErrorHandle)||(fnOnApiDataUrlErrorHandle=kRVOptions.dataUrlErrorHandle)),fnOnApiDataUrlErrorHandle&&(_.isFunction(fnOnApiDataUrlErrorHandle)?fnOnApiDataUrlErrorHandle(jqXHR,textStatus,errorThrown):_.isString(fnOnApiDataUrlErrorHandle)&&eval("("+fnOnApiDataUrlErrorHandle+"(jqXHR, textStatus, errorThrown))"))}})):klib.console.error("data-api-url not found. Please check the arguments or html markup. Skipped this data-api request"),dataIndexApi++})}else klib.console.warn("Invalid [data-urls].Check the arguments or html markup. Rendering with empty data {}.")}else if(dataModelUrl.beginsWith("local:","i")){var localDataModelName=dataModelUrl.replace(/local:/gi,""),localDataModelObj={};if("undefined"!=typeof eval("("+localDataModelName+")")&&eval("(localDataModelObj="+localDataModelName+")"),klib.console.info("Using LOCAL Data Model: "+localDataModelName),klib.isBlank(kViewDataModelType))!isLocalDataModel&&dataModelName.indexOf(".")>0?kTemplateModelData[viewDataModelName]=klib.hasKey(localDataModelObj,dataModelName)?klib.find(localDataModelObj,dataModelName):localDataModelObj:kTemplateModelData[viewDataModelName]=localDataModelObj.hasOwnProperty(dataModelName)?localDataModelObj[dataModelName]:localDataModelObj;else if(klib.console.info("Local Data: "+localDataModelName+" not found."),$.isEmptyObject(localDataModelObj)&&!$.isEmptyObject(kBackboneModelOption)){var bbClassUrl=kBackboneModelOption.classpath||"";if(klib.isBlank(bbClassUrl))klib.console.error("Backbone 'classpath' NOT defined. Please check the 'dataModelType' option.");else{if(bbClassUrl.beginsWith("local:","i")){var bbClassLocal=bbClassUrl.substring(6);eval("( localDataModelObj = new "+bbClassLocal+"() )")}else{klib.console.info("loading Backbone Model Class from: "+bbClassUrl+".");var noop=function(){},loadBackboneModelClassResult=klib.loadBackboneModelClass(bbClassUrl,{success:kBackboneModelOption.classsuccess||noop,fail:kBackboneModelOption.classerror||noop});localDataModelObj=new loadBackboneModelClassResult.bbclass,loadBackboneModelClassResult.success&&(kBackboneModelOption.defaults&&localDataModelObj.set(kBackboneModelOption.defaults),localDataModelObj.fetch({async:!1,cache:!1,success:kBackboneModelOption.fetchsuccess||noop,error:kBackboneModelOption.fetcherror||noop}))}eval("("+localDataModelName+"=localDataModelObj)"),kTemplateModelData[viewDataModelName]=localDataModelObj.toJSON()}}else kTemplateModelData[viewDataModelName]=kViewDataModelType.equalsIgnoreCase("backbone")?localDataModelObj.toJSON():localDataModelObj}else klib.console.info("Request Data ["+dataModelName+"] [cache:"+kRVOptions.dataCache+"] from URL =>"+dataModelUrl),kAjaxRequestsQue.push($.ajax({url:dataModelUrl,data:kRVOptions.dataParams,cache:kRVOptions.dataCache,dataType:"text",success:function(e){var t=(""+e).toJSON();dataModelName.indexOf(".")>0?kTemplateModelData[viewDataModelName]=klib.hasKey(t,dataModelName)?klib.find(t,dataModelName):t:kTemplateModelData[viewDataModelName]=t.hasOwnProperty(dataModelName)?t[dataModelName]:t,klib.console.info("Loaded data model ["+dataModelName+"] from ["+dataModelUrl+"]")},error:function(jqXHR,textStatus,errorThrown){var fnOnDataUrlErrorHandle=(""+$(viewContainerId).data("urlErrorHandle")).replace(/undefined/,"");klib.isBlank(kRVOptions.dataUrlErrorHandle)||(fnOnDataUrlErrorHandle=""+kRVOptions.dataUrlErrorHandle),klib.isBlank(fnOnDataUrlErrorHandle)||eval("("+fnOnDataUrlErrorHandle+"(jqXHR, textStatus, errorThrown))")}}))}if(klib.console.info("End of Data Processing"),klib.console.log({o:kTemplateModelData}),klib.console.groupEnd("kDataModel"),dataFound){var vTemplate2RenderInTag=(""+$(viewContainerId).data("template")).replace(/undefined/,""),vTemplatesList=(""+$(viewContainerId).data("templates")).replace(/undefined/,"");vTemplatesList&&klib.isBlank((vTemplatesList||"").replace(/[^:'\"]/g,""))&&(vTemplatesList="'"+vTemplatesList.split(",").join("','")+"'");var vTemplates=klib.toJSON(vTemplatesList||"{}");if(!_.isObject(kRVOptions.dataTemplates)&&_.isString(kRVOptions.dataTemplates)&&(vTemplatesList=(kRVOptions.dataTemplates||"").trim(),klib.isBlank((vTemplatesList||"").replace(/[^:'\"]/g,""))&&(vTemplatesList="'"+vTemplatesList.split(",").join("','")+"'"),kRVOptions.dataTemplates=klib.toJSON(vTemplatesList)),$.isEmptyObject(kRVOptions.dataTemplates)||(vTemplates=kRVOptions.dataTemplates,vTemplatesList=""+JSON.stringify(vTemplates)),(_.isEmpty(klib.toJSON((vTemplatesList||"").trim()))||_.isArray(vTemplates)&&1==vTemplates.length&&klib.isBlank(vTemplates[0]))&&(vTemplates={},vTemplatesList=""),klib.console.info("Templates:"),klib.console.info(vTemplates),_.isArray(vTemplates)&&!_.isEmpty(vTemplates)){klib.console.info("Array of template(s) without templateID(s).");var newTemplatesObj={},dynTmplIDForContainer="__tmpl_"+viewContainerId.trim("#")+"_";_.each(vTemplates,function(e,t){klib.console.log(e),e&&(newTemplatesObj[dynTmplIDForContainer+t]=""+e)}),klib.console.info("Template(s) with template ID(s)."),console.log(newTemplatesObj),_.isEmpty(newTemplatesObj)?(vTemplates={},vTemplatesList=""):(vTemplates=newTemplatesObj,vTemplatesList=""+JSON.stringify(vTemplates))}if(!vTemplates||$.isEmptyObject(vTemplates)){vTemplates={};var _dataTemplate=kRVOptions.dataTemplate,_tmplKey="",_tmplLoc="";klib.isBlank(_dataTemplate)&&(klib.isBlank(vTemplate2RenderInTag)||(klib.console.info("Template to load from location <"+vTemplate2RenderInTag+">"),_dataTemplate=vTemplate2RenderInTag)),_dataTemplate=(_dataTemplate||"").trim(),klib.console.info("Primary Template: <"+_dataTemplate+">"),klib.isBlank(_dataTemplate)||_dataTemplate.equalsIgnoreCase("inline")||_dataTemplate.equals(".")?(klib.console.info("Using target container (inline) content as template."),_tmplKey="_tmplInline_"+viewContainerId.trim("#")):_dataTemplate.beginsWith("#")?(klib.console.info("Using page container <"+_dataTemplate+"> content as template."),_tmplKey=_dataTemplate.trim("#")):(klib.console.info("External path <"+_dataTemplate+"> content as template."),_dataTemplate.contains(":")&&!_dataTemplate.beginsWithIgnoreCase("http")?(_tmplKey=klib.getOnSplit(_dataTemplate,":",0).replace(/[^a-z0-9]/gi,""),_tmplLoc=klib.getOnLastSplit(1)):(_tmplKey="__tmpl_"+viewContainerId.trim("#")+"_"+klib.now()+klib.rand(1e3,9999),_tmplLoc=_dataTemplate)),vTemplates[_tmplKey]=_tmplLoc.replace(/['\"]/g,""),klib.console.info(vTemplates)}klib.console.group("kView");var dataTemplatesCollectionUrl=(""+$(viewContainerId).data("templatesCollectionUrl")).replace(/undefined/,"");if(klib.isBlank(kRVOptions.dataTemplatesCollectionUrl)||(dataTemplatesCollectionUrl=kRVOptions.dataTemplatesCollectionUrl),!klib.isBlank(dataTemplatesCollectionUrl)){var templateCollectionId=viewContainerId+"_TemplatesCollection";klib.loadTemplatesCollection(templateCollectionId,dataTemplatesCollectionUrl)}if(vTemplates&&!$.isEmptyObject(vTemplates)){klib.console.info("Templates of ["+kTemplateType+"] to be used in view container ["+viewContainerId+"] => "+JSON.stringify(vTemplates));var vTemplateNames=_.keys(vTemplates);if(klib.console.group("kLoadingTemplates"),klib.console.group("kLoadingTemplatesCache"),useOptions&&uOptions.hasOwnProperty("dataTemplatesCache"))klib.console.info("Override [data-templates-cache] with user option [dataTemplatesCache]: "+kRVOptions.dataTemplatesCache);else{var templatesCacheInTagData=(""+$(viewContainerId).data("templatesCache")).replace(/undefined/,"");klib.isBlank(templatesCacheInTagData)||(kRVOptions.dataTemplatesCache=templatesCacheInTagData.toBoolean(),klib.console.info("Override [data-templates-cache] with [data-templates-cache] option in tag-attribute: "+kRVOptions.dataTemplatesCache))}klib.console.groupEnd("kLoadingTemplatesCache"),klib.console.info("Load Templates"),klib.console.info(vTemplates),_.each(vTemplateNames,function(e,t){klib.console.info([t,e,vTemplates[e],kTemplateType,viewContainerId]),kAjaxRequestsQue=klib.loadTemplate(e,vTemplates[e],kTemplateType,viewContainerId,kAjaxRequestsQue,!kRVOptions.dataTemplatesCache)});var vTemplate2RenderID="#"+vTemplateNames[0].trim("#");if(klib.console.info("External Data/Templates Loading Status: "+JSON.stringify(kAjaxRequestsQue)),klib.console.groupEnd("kLoadingTemplates"),klib.console.info("Render TemplateID: "+vTemplate2RenderID),klib.console.group("kLoadingViewStyles"),useOptions&&uOptions.hasOwnProperty("dataStylesCache"))klib.console.info("Override [data-styles-cache] with user option [dataStylesCache]: "+kRVOptions.dataStylesCache);else{var stylesCacheInTagData=(""+$(viewContainerId).data("stylesCache")).replace(/undefined/,"");klib.isBlank(stylesCacheInTagData)||(kRVOptions.dataStylesCache=stylesCacheInTagData.toBoolean(),klib.console.info("Override [data-styles-cache] with [data-styles-cache] option in tag-attribute: "+kRVOptions.dataStylesCache))}var vStylesList=(""+$(viewContainerId).data("styles")).replace(/undefined/,"");vStylesList&&klib.isBlank((vStylesList||"").replace(/[^:'\"]/g,""))&&(vStylesList="'"+vStylesList.split(",").join("','")+"'");var vStyles=klib.toJSON(vStylesList||"{}");if($.isEmptyObject(kRVOptions.dataStyles)||(vStyles=kRVOptions.dataStyles),_.isArray(vStyles)&&_.remove(vStyles,function(e){return!e}),vStyles&&!$.isEmptyObject(vStyles)){if(_.isArray(vStyles)){klib.console.info("Convert array of style(s) without styleID to object with styleID(s).");var newStylesObj={},dynStyleIDForContainer="__styles_"+viewContainerId.trim("#")+"_";_.each(vStyles,function(e,t){klib.console.log(e),e&&(newStylesObj[dynStyleIDForContainer+t]=""+e)}),klib.console.info("Style(s) with styleID(s)."),klib.console.log(newStylesObj),vStyles=_.isEmpty(newStylesObj)?{}:newStylesObj}klib.console.info("External styles to be loaded [cache:"+kRVOptions.dataStylesCache+"] along with view container ["+viewContainerId+"] => "+JSON.stringify(vStyles));var vStylesNames=_.keys(vStyles);klib.console.group("kLoadingStyles"),_.each(vStylesNames,function(e){kAjaxRequestsQue=klib.loadStyle(e,vStyles[e],kRVOptions.dataStylesCache,kAjaxRequestsQue)}),klib.console.info("External Styles Loading Status: "+JSON.stringify(kAjaxRequestsQue)),klib.console.groupEnd("kLoadingStyles")}else klib.console.info("No styles defined [data-styles] in view container ["+viewContainerId+"] to load.");klib.console.groupEnd("kLoadingViewStyles"),$.when.apply($,kAjaxRequestsQue).then(function(){klib.console.group("kRender["+kRenderEngine+"*"+kTemplateEngine+"] - klib.renderHistory["+retValue.id+"]"),klib.console.info("Rendering "+viewContainerId+" using master template: "+vTemplate2RenderID),$(viewContainerId).html("");try{retValue.model=kTemplateModelData[viewDataModelName];var e,t=kTemplateModelData[viewDataModelName];switch(kRenderEngine){case"backbone":(!isLocalDataModel||klib.isBlank(kViewDataModelType))&&(retValue.model=new Backbone.Model(retValue.model),t=retValue.model.toJSON());break;default:if(isLocalDataModel&&!klib.isBlank(kViewDataModelType))switch(kViewDataModelType){case"backbone":t=retValue.model.toJSON();
}}klib.viewModels[retValue.id]=retValue.model;var a=$(vTemplate2RenderID).html()||"";switch(kTemplateEngine){case"handlebar":case"handlebars":e=Handlebars.compile(a)(t);break;case"underscore":e=_.template(a)(t);break;case"underscore-as-mustache":var n={interpolate:/\{\{(.+?)\}\}/g,escape:/\{\{\{(.+?)\}\}\}/g};e=_.template(a,t,n);break;case"mustache":e=Mustache.compile(a)(t);break;case"hogan":e=Hogan.compile(a).render(t);break;default:e=a}switch(kRenderEngine){case"backbone":retValue.view=new(Backbone.View.extend({el:viewContainerId,render:function(){return this.$el.html(e),this}})),retValue.view.render();break;default:retValue.view=e,$(viewContainerId).html(retValue.view)}klib.console.info("Render: SUCCESS");var i=_.keys(klib.renderHistory),l=i.length;l>klib.renderHistoryMax&&$.each(i.splice(0,l-klib.renderHistoryMax),function(e,t){delete klib.renderHistory[t]}),retValue.cron=""+klib.now(),klib.renderHistoryMax>0&&(klib.renderHistory[retValue.id]=retValue),klib.reflowFoundation(viewContainerId),klib.initKeyTracking(),klib.i18n.apply(viewContainerId),klib.initRoutes(viewContainerId);var o=(""+$(viewContainerId).data("renderCallback")).replace(/undefined/,"");if(kRVOptions.dataRenderCallback&&(o=kRVOptions.dataRenderCallback),klib.console.info("Processing callback: "+o),isKHashRouteOn&&klib.routes&&klib.routes.hasOwnProperty("_renderCallback")&&_.isFunction(klib.routes._renderCallback)&&klib.routes._renderCallback.call(void 0,retValue),o){var r=o;_.isString(r)&&(r=klib.findSafe(window,r)),r?_.isFunction(r)?r.call(void 0,retValue):klib.console.error("CallbackFunction <"+o+" = "+r+"> is NOT a valid FUNCTION."):(""+o).beginsWith("klib")&&(""+o).endsWith("_renderCallback")?klib.console.warn("Default Route renderCallback function <"+o+"> is NOT defined."):klib.console.error("CallbackFunction <"+o+"> is NOT defined.")}$("[rel='kRender'],[data-render],[data-krender]",viewContainerId).kRender()}catch(s){klib.console.error("Error Rendering: "+s.message)}klib.console.groupEnd("kRender["+kRenderEngine+"*"+kTemplateEngine+"] - klib.renderHistory["+retValue.id+"]")}).fail(function(){klib.console.error("External Data/Templates/Styles/Scripts Loading failed! Unexpected!! Check the template Path / Network. Rendering aborted.")}).done(klib.runOnceOnRender)}else klib.console.error("No templates defined [data-templates] in view container ["+viewContainerId+"] to render. Check HTML markup.");klib.console.groupEnd("kView")}return retValue},klib.hasAutoRoutes=function(e,t){var a="[data-kroute-default]"+(e?"[href"+(t?t:"")+"='"+e+"']":"");return $(a).length>0},klib.routeCurLocHashAttemptDelaySec=3,klib.routeCurLocHashAttempt=0,klib.routeCurLocHash=function(){var e=(klib.getLocHash()||"").ifBlank(klib.routesOptions.defaultPageRoute);isKHashRouteOn&&e&&!klib.hasAutoRoutes(e)&&(klib.console.info("Route current url-hash."),klib.route(e)||(klib.console.warn("Current url-hash-route <"+e+"> FAILED and will try after "+klib.routeCurLocHashAttemptDelaySec+"sec."),klib.routeCurLocHashAttempt<5?(klib.routeCurLocHashAttempt++,setTimeout(klib.routeCurLocHash,1e3*klib.routeCurLocHashAttemptDelaySec)):klib.console.error("5 attempts to route current url-hash failed. Aborting further attempts.")))},klib.finallyOnRender=[],klib.runOnceOnRenderFunctions=[klib.routeCurLocHash],klib.runOnceOnRender=function(){klib.console.info("Render Complete."),(klib.runOnceOnRenderFunctions&&!_.isEmpty(klib.runOnceOnRenderFunctions)||klib.finallyOnRender&&!_.isEmpty(klib.finallyOnRender))&&(klib.runOnceOnRenderFunctions||(klib.runOnceOnRenderFunctions=[]),_.isArray(klib.runOnceOnRenderFunctions)||(klib.runOnceOnRenderFunctions=[klib.runOnceOnRenderFunctions]),_.isArray(klib.runOnceOnRenderFunctions)&&(klib.finallyOnRender&&(_.isArray(klib.finallyOnRender)||(klib.finallyOnRender=[klib.finallyOnRender]),klib.runOnceOnRenderFunctions=klib.runOnceOnRenderFunctions.concat(klib.finallyOnRender)),_.each(klib.runOnceOnRenderFunctions,function(e,t){_.isFunction(e)&&e()})),klib.finallyOnRender=klib.runOnceOnRenderFunctions=void 0)},klib.setElIdIfNot=function(e){var t=$(e);return klib.isBlank(t.attr("id"))&&t.attr("id","_el_"+klib.now()+"_"+klib.rand(1e3,9999)),t.attr("id")},klib.reflowFoundation=function(e){"Foundation"in window&&$(e||document).foundation("reflow")},$.expr[":"].regex=function(e,t,a){var n=a[3].split(","),i=/^(data|css):/,l={method:n[0].match(i)?n[0].split(":")[0]:"attr",property:n.shift().replace(i,"")},o="ig",r=new RegExp(n.join("").replace(/^\s+|\s+$/g,""),o);return r.test($(e)[l.method](l.property))},$.fn.extend({kRender:function(e){this.each(function(){__renderView(this,e)})}}),$.extend({kRender:function(e,t){$(e).kRender(t)}}),klib.initDataValidation=function(){klib.console.log("include validate framework lib (klib-validate.js) to use this feature!")},klib.doDataValidation=function(){klib.console.log("include validate framework lib (klib-validate.js) to use this feature!")},klib.properties={version:klib.VERSION},klib.routes={},klib.routesOptions={useHashRoute:!0,usePatterns:!0,defaultPageRoute:"",beforeRoute:"",defaultTemplateExt:".html",loadDefaultScript:!0,defaultRouteTargetContainerIdPrefix:"routeContainer_",defaultRouteTemplateContainerIdPrefix:"template_"},klib.routePatterns={routes:[],register:void 0,deregister:void 0},klib.routePatterns.register=function(e,t){if(e&&!_.isEmpty(e)){var a=function(e,t){_.has(e,"pattern")&&(e.pattern=e.pattern.replace(/\?/g,"\\?"),_.has(e,"name")||(e.name=e.pattern.replace(/[^a-z0-9_]/gi,"")),_.has(e,"routeoptions")||(e.routeoptions={}),_.find(klib.routePatterns.routes,{pattern:e.pattern})||(_.find(klib.routePatterns.routes,{name:e.name})?t&&klib.routePatterns.routes.push(e):klib.routePatterns.routes.push(e)))};_.isArray(e)?_.each(e,function(e){a(e,t)}):_.isObject(e)?a(e,t):klib.console.error("Invalid RoutePattern Options. Provide Array/Object of RouteOptions")}else klib.console.error("Empty RoutePattern Options.")},klib.routePatterns.deregister=function(e){if(e&&!_.isEmpty(e)){var t=function(e){if(e){var t=_.findIndex(klib.routePatterns.routes,function(t){return t.name==e||t.pattern==e});t>=0?_.pullAt(klib.routePatterns.routes,t):klib.console.error("Route Pattern Not Found for <"+e+">")}};_.isArray(e)?_.each(e,function(e){t(e)}):_.isString(e)?t(e):klib.console.error("Invalid RoutePattern Name/Pattern. Provide Array/Name of RouteNames/Patterns")}},klib.routeName=function(e){var t=e||klib.urlHash();return t.contains("\\?")&&(t=t.split("?")[0]),t.trimLeft("#").replace(/[^a-z0-9]/gi,"_")},klib.routeContainerId=function(e){var t=klib.routesOptions.defaultRouteTargetContainerIdPrefix.trimLeft("#");return t+klib.routeName(e)},klib.routeTemplateId=function(e){var t=klib.routesOptions.defaultRouteTemplateContainerIdPrefix.trimLeft("#");return t+klib.routeName(e)},klib.routeRender=function(e,t){var a=e?$(e):void 0,n=a?""+a.data("kroute")||"":"";(n.trim().equalsIgnoreCase("false")||n.trim().equalsIgnoreCase("no")||n.trim().equalsIgnoreCase("off"))&&(n="quit:true");var i=n?klib.toJSON(n):{};if(_.merge(i,t),!i.hasOwnProperty("quit")||!i.quit){var l="#RouteNotDefinedInHREF";a?l=a.attr("href"):t.urlhash&&(l=t.urlhash.url),l=l.trimLeft("#");var o="";if(l.contains("\\?")){var r=l.split("?");l=r[0],o=r[1]}var s=i.name||klib.routeName(l);if(klib.routes[s])klib.routes[s](a,o,i);else{klib.console.info("Route method <klib.routes."+s+"> NOT FOUND. Attempting to route using [data-kroute] options.");var d=i.hasOwnProperty("ext")||i.hasOwnProperty("tmplext")||i.hasOwnProperty("tmplExt"),c=""+(i.target||"").trim(),u=d?i.ext||i.tmplext||i.tmplExt:klib.routesOptions.defaultTemplateExt||"",p=i.tmplengine||i.tmplEngine||"",k=(l+u+"?"+o).trimRight("\\?"),f=l+".js",b="klib.routes."+s+"_before",m="klib.routes."+s+"_renderCallback",h=klib.findIgnoreCase(i,"usetargetoptions"),g={dataRenderCallback:m,rElRouteOptions:i,rElDataAttr:a?a.data():{}};i.hasOwnProperty("template")&&!i.hasOwnProperty("templates")&&(i.templates=i.template,delete i.template),c.equalsIgnoreCase(".")?c="#"+klib.setElIdIfNot(a):klib.isBlank(c)&&(c="#"+klib.routeContainerId(s));var v=klib.isElementExist(c);klib.console.info("Render Target <"+c+">"),i.hasOwnProperty("dataCache")&&(g.dataCache=i.dataCache),i.hasOwnProperty("templatesCache")&&(g.dataTemplatesCache=i.templatesCache),i.hasOwnProperty("scriptsCache")&&(g.dataScriptsCache=i.scriptsCache),g.dataTemplates={};var O="__kRouteTemplate_"+s;if(!i.hasOwnProperty("templates")||i.templates){var y=i.templates,C=klib.routeTemplateId(s),w="#"+C,F="__tmpl_"+C;switch(!0){case _.isString(y):var S=O,T=y.trim();T.equalsIgnoreCase(".")?T=k:T.equalsIgnoreCase("#")&&(S=F,T=w),g.dataTemplates[S]=T.ifBlank("none");break;case _.isArray(y):_.indexOf(y,".")>=0&&(g.dataTemplates[O+"_dot"]=k,_.pull(y,".")),_.indexOf(y,"#")>=0&&(g.dataTemplates[F]=w,_.pull(y,"#")),_.each(y,function(e,t){g.dataTemplates[O+"_"+(t+1)]=e.ifBlank("none")});break;default:g.dataTemplates[O]=k}}else klib.console.warn("Route without template"),g.dataTemplates[O]="none";p&&(g.dataTemplateEngine=p);var D=!i.hasOwnProperty("scripts")||i.scripts;if(D){g.dataScripts={};var R="__kRouteScript_"+s;switch(!0){case _.isString(i.scripts):g.dataScripts[R]=_.indexOf(i.scripts,".")>=0?f:i.scripts;break;case _.isArray(i.scripts):_.indexOf(i.scripts,".")>=0&&(g.dataScripts[R]=f,_.pull(i.scripts,".")),_.each(i.scripts,function(e,t){g.dataScripts[R+"_"+(t+1)]=e});break;default:klib.routesOptions.loadDefaultScript?g.dataScripts[R]=f:klib.console.warn("Script(s) not included. Use <klib.routesOptions.loadDefaultScript = true> to load default script <"+f+">.")}klib.console.log(g.dataScripts)}if(i.dataUrl||i.dataurl){var E=i.dataurl||i.dataUrl,x=klib.toRenderDataStructure(E,o);_.isEmpty(x)||_.merge(g,x)}var M=i.hasOwnProperty("after")||i.hasOwnProperty("callback")||i.hasOwnProperty("callBack");if((M||i.after||i.callback||i.callBack)&&(g.dataRenderCallback=i.after||i.callback||i.callBack||""),i.hasOwnProperty("scripts")&&klib.isBlank(i.hasOwnProperty("scripts"))&&(M?_.isString(g.dataRenderCallback)&&g.dataRenderCallback.equalsIgnoreCase(".")&&(g.dataRenderCallback=m):g.dataRenderCallback=""),h&&v){var V=$(c);V.data("url")&&delete g.dataUrl,(V.data("template")||V.data("templates"))&&delete g.dataTemplates,V.data("scripts")&&delete g.dataScripts,V.data("templateEngine")&&delete g.dataTemplateEngine,V.data("renderCallback")&&delete g.dataRenderCallback}klib.console.info("Route Render Options Before preRenderProcess:"),klib.console.info(g);var A={},I=i.before||i.beforeroute||i.beforeRoute||klib.routesOptions.beforeRoute;klib.console.info("callBeforeRoute: "+I),I&&(!_.isFunction(I)&&_.isString(I)&&(I.equals(b)&&(b=void 0),I=klib.findSafe(window,I)),_.isFunction(I)?(A=I.call(void 0,{el:a,target:c,renderOptions:g,routeOptions:i}),_.isObject(A)&&_.merge(g,A)):klib.console.error("CallBeforeRouteFunction <"+i.before+"> NOT FOUND.")),b&&(I=klib.findSafe(window,b),I&&_.isFunction(I)&&(A=I.call(void 0,{el:a,target:c,renderOptions:g,routeOptions:i}),_.isObject(A)&&_.merge(g,A))),klib.console.info("Route Render Options After preRenderProcess:"),klib.console.info(g),g.hasOwnProperty("render")&&!g.render||i.hasOwnProperty("render")&&!i.render||klib.render(c,g)}return!0}},klib.route=function(e,t){if(_.isString(e)&&klib.isBlank((""+e).trim("#")))return!1;var a=!_.isString(e);if(t=t||{},!a){var n=$("[data-kroute][href='"+e+"']");if(a=!_.isEmpty(n))e=n.get(0);else if(klib.console.warn("Route source element NOT FOUND for route <"+e+">"),klib.routesOptions.usePatterns){klib.console.info("Searching RoutePattern.");var i,l=_.findIndex(klib.routePatterns.routes,function(t){var a=!1,n=klib.routeMatch(t.pattern,e);return n&&(a=!0,i=_.merge({},t.routeoptions||{}),i.urlhash={pattern:t.pattern.replace(/\\\?/g,"?"),url:e,urlParams:n}),a});0>l?(klib.console.warn("Pattern not found."),klib.console.info(klib.routePatterns.routes)):(klib.console.info(i),klib.routeRender(void 0,i))}else klib.console.warn("Pattern match Disabled.")}if(!a){if(!t.forceroute&&!t.forceRoute)return klib.console.warn("Exit Route."),!1;klib.console.warn("Attempt dynamic route."),a=!0,e=$("<a href='"+e+"'></a>").get(0)}return a?klib.routeRender(e,t):void 0},klib.initRoutes=function(e,t){"object"==typeof e&&(t=e,e=t.context||t.scope||""),(!t||(klib.console.info("Init routesOptions"),_.merge(klib.routesOptions,t),!isKHashRouteOn&&klib.routesOptions.useHashRoute&&klib._initWindowOnHashChange(),isKHashRouteOn&&!klib.routesOptions.useHashRoute&&klib._stopWindowOnHashChange(),t.hasOwnProperty("context")||t.hasOwnProperty("scope")))&&(klib.console.info("Init kRoutes. Scan for [data-kroute] in context: <"+(e||"body")+">"),$(e||"body").find("[data-kroute]").each(function(e,t){klib.isBlank((($(t).attr("href")||"")+"#").split("#")[1])||($(t).off("click"),$(t).on("click",function(){if(isKHashRouteOn){var e="#"+(($(t).attr("href")||"")+"#").split("#")[1].trim("#"),a=klib.getLocHash();e.equals(a)&&klib.route(this)}else klib.route(this)}),t.hasAttribute("data-kroute-default")&&klib.route(t))}))},$(document).ready(function(){klib.debug=klib.urlParam("klib.debug")||klib.hashParam("klib.debug")||klib.debug,klib.reflowFoundation(),klib.initRoutes(),klib.extendBackbone(),klib.initKeyTracking(),klib.console.info("Find and Render [rel='kRender'] or [data-render] or ,[data-krender]"),$("[rel='kRender'],[data-render],[data-krender]").kRender()})}(this),klib.console.info("klib loaded.");/** @license K-Lib Validation Extension | (c) Kumararaja <sucom.kumar@gmail.com> | License (MIT) */
var _isOnOfflineValidation,_validateAlertTemplate='<div class="errortxt break-txt" data-i18n=""></div>',_check={required:_fnRequired,digits:_fnValidDigits,numbers:_fnValidNumbers,integer:_fnValidInteger,alphabet:_fnValidAlpha,alphanumeric:_fnValidAlphaNumeric,pattern:_fnValidPatternMatch,range:_fnValidValueRange,fixedlength:_fnValidLengths,minlength:_fnValidLengthMin,maxlength:_fnValidLengthMax,email:_fnValidEmail,url:_fnValidUrl,date:_isValidDate,cardno:_fnValidCardNo,ipv4:_fnValidIpv4,ipv6:_fnValidIpv6,ipaddress:_fnValidIpAddress,subnetmask:_fnValidSubnet,phoneUS:_fnValidPhoneUS,wordsize:_fnValidWordSize},_offlineValidationRules={};klib.initDataValidation=function(e){var t=function(e){return e=e||{},_.each(_.keys(e),function(t){t.indexOf("_")>0&&(_.each(t.split("_"),function(a){e[a]?_.isArray(e[a])?e[a].push(e[t]):e[a]=[e[a],e[t]]:e[a]=[e[t]]}),delete e[t])}),e};e=e||"body";var a=$(e),n=a.data("validateElFilter")||"",i=t(klib.toJSON(a.data("validateCommon")||"{}"));klib.console.log(_.keys(i));var l,o,r,s,d,c=a.data("offlineValidationStoreKey")||"",u=!klib.isBlank(c);u&&(_offlineValidationRules[c]={rules:{}}),a.find(n+"[data-validate]").each(function(e,a){var n=$(a).prop("id"),p={},k=$(a).data("validate");if(k&&k.indexOf("{")<0){var f=($(a).data("validateEvents")||"onBlur").replace(/[^a-z]/gi," ").normalizeStr().replace(/ /g,"_"),b=",offline:"+($(a).data("validateOffline")||"false"),m="{fn:"+k.replace(/[,;]/," ").normalizeStr().replace(/ /g,b+"},{fn:")+b+"}";k="{"+f+":["+m+"]}"}p=t(klib.toJSON(k)),klib.console.log(k),_.each(_.keys(i),function(e){var t=i[e];_.isArray(t)||(t=[t]),_.each(t,function(t){if(l=!0,o="<",s=t.offline||!1,r=!1,t.el){var a=t.el.replace(/ /g,"").split(","),i=t.el.replace(/[< >!]/g,"").split(","),c=_.indexOf(i,n);l=c>=0,l&&(o=a[c].indexOf(">")>=0?">":"<",r=a[c].indexOf("!")>=0)}else t.ex&&(l=_.indexOf(t.ex.replace(/[< >!]/g,"").split(","),n)<0);l&&(d=_.omit(t,["el","ex"]),r&&(d=_.extend(d,{offline:!s})),p[e]||(p[e]=[]),p[e]="<"===o?_.union([d],p[e]):_.union(p[e],[d]))})}),_.each(_.keys(p),function(e){var t=e.substring(2,3).toLowerCase()+e.substring(3);klib.console.log("settingup event on["+t+"]..."),_.isArray(p[e])||(p[e]=[p[e]]),u&&_.each(p[e],function(e){e.offline&&(_offlineValidationRules[c].rules[n]||(_offlineValidationRules[c].rules[n]=[]),_.indexOf(_offlineValidationRules[c].rules[n],e.fn)<0&&_offlineValidationRules[c].rules[n].push(e.fn))}),$(a).on(t,function(){_.every(p[e],function(e){return _.isArray(e)?_.every(e,function(e){return e.fn(a,e.msg||$(a).data("validateMsg")||"")}):e.fn(a,e.msg||$(a).data("validateMsg")||"")})})})})},klib.doDataValidation=function(e){var t=e.replace(/#/g,""),a="#"+t,n=$(a),i={};if(_offlineValidationRules[t]){var l=_offlineValidationRules[t].rules,o=function(e){var t=n.find("#"+e),a=klib.toBoolean(t.data("ignoreValidationIfInvisible"))&&!t.is(":visible");return a||(a=_.every(l[e],function(e){var a=e(t);return a||(i={errcode:2,el:t,fn:e}),a})),a};if($.isEmptyObject(l))i={errcode:1,errmsg:"Rules not found in scope ["+e+"]."};else{_isOnOfflineValidation=!0;_.every(_.keys(l),function(e){return o(e)});_isOnOfflineValidation=!1}}else i={errcode:1,errmsg:"Scope not found."};return i};