/** @license K-Lib Validation Extension | (c) Kumararaja <sucom.kumar@gmail.com> | License (MIT) */
function _fnRequired(a,e){var t=klib.getElValue(a);return _showValidateMsg(a,e,!klib.isBlank(t))}function _fnValidDigits(a,e){var t=$(a).val(),n=0===t.length||/^\d+$/.test(t);return _showValidateMsg(a,e,n)}function _fnValidNumbers(a,e){var t=$(a).val(),n=0===t.length||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(t);return _showValidateMsg(a,e,n)}function _fnValidInteger(a,e){var t=$(a).val(),n=0===t.length||/^-?\d+$/.test(t);return _showValidateMsg(a,e,n)}function _fnValidAlpha(a,e){var t=$(a).val(),n=0===t.length||!/[^a-z]/gi.test(t);return _showValidateMsg(a,e,n)}function _fnValidAlphaNumeric(a,e){var t=$(a).val(),n=0===t.length||!/[^a-z0-9]/gi.test(t);return _showValidateMsg(a,e,n)}function _fnValidPatternMatch(a,e){var t=$(a).val(),n=0===t.length;if(!n){var i=new RegExp($(a).data("validatePattern"),$(a).data("validatePatternOptions").replace(/!/g,""));n=i.test(t),$(a).data("validatePatternOptions").indexOf("!")>=0&&(n=!n)}return _showValidateMsg(a,e,n)}function _fnValidValueRange(a,e){var t=$(a).val(),n=0===t.length;if(!n&&(n=!1,/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(t))){var i=klib.toFloat(t),l=(" "+($(a).data("validateRange")||"")+": ").split(":"),F=!klib.isBlank(l[0]),u=!klib.isBlank(l[1]),d=klib.toFloat(l[0]),r=klib.toFloat(l[1]);F&&u?n=i>=d&&r>=i:F?n=i>=d:u&&(n=r>=i)}return _showValidateMsg(a,e,n)}function _fnValidLengthMin(a,e){var t=$(a).val(),n=klib.toInt($(a).attr("minlength")),i=t.length>=n;return _showValidateMsg(a,e,i)}function _fnValidLengthMax(a,e){var t=$(a).val(),n=klib.toInt($(a).attr("maxlength")),i=t.length<=n;return _showValidateMsg(a,e,i)}function _fnValidLengths(a,e){var t=$(a).val(),n=t.length,i=klib.toInt($(a).attr("minlength")),l=klib.toInt($(a).attr("maxlength")),F=n>=i&&l>=n;return _showValidateMsg(a,e,F)}function _fnValidWordSize(a,e){var t=$(a).val(),n=_.max(_.map((""+t).replace(/[-\n]/g," ").split(" "),function(a){return a.length})),i=klib.toInt($(a).data("validWordSize"))||20,l=i>=n;return _showValidateMsg(a,e,l)}function _fnValidEmail(a,e){var t=$(a).val(),n=0===t.length;return n||(n=(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(t)||/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/i.test(t))&&/[a-z0-9]/i.test(t[t.length-1])),_showValidateMsg(a,e,n)}function _fnValidUrl(a,e){var t=$(a).val(),n=0===t.length;return n||(n=/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(t)),_showValidateMsg(a,e,n)}function _isValidDate(a,e){var t=$(a).val(),n=0===t.length;if(!n){n=!1;var i,l,F,u=["","JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],d=["","JANUARY","FEBRUARY","MARCH","APRIL","MAY","JUNE","JULY","AUGUST","SEPTEMBER","OCTOBER","NOVEMBER","DECEMBER"],r=$(a).data("validateFormat")||"YMD",o="^\\d{1,2}[\\/\\-\\.]\\d{1,2}[\\/\\-\\.]\\d{4}$",s=t.replace(/[^a-z]/gi,"");if(s){var f=_.indexOf(u,s.toUpperCase());0>=f&&(f=_.indexOf(d,s.toUpperCase())),f>0&&(t=t.replace(new RegExp(s,"gi"),f))}t=t.replace(/[^0-9]/g," ").normalizeStr().replace(/ /g,"/");var g=t.split("/");switch(r.toUpperCase()){case"YMD":o="^\\d{4}[\\/\\-\\.]\\d{1,2}[\\/\\-\\.]\\d{1,2}$",i=g[0],l=g[1],F=g[2];break;case"MDY":l=g[0],F=g[1],i=g[2];break;case"DMY":F=g[0],l=g[1],i=g[2]}if(new RegExp(o,"").test(t)){F=parseInt(F,10),l=parseInt(l,10),i=parseInt(i,10);var c=new Date(i,l-1,F);n=c.getFullYear()===i&&c.getMonth()===l-1&&c.getDate()===F}}return _showValidateMsg(a,e,n)}function _fnValidCardNo(a,e){var t=$(a).val(),n=0===t.length;if(!n)if(/[^0-9 \-]+/.test(t))n=!1;else{for(var i=0,l=0,F=!1,u=t.replace(/\D/g,""),d=u.length-1;d>=0;d--){var r=u.charAt(d);l=parseInt(r,10),F&&(l*=2)>9&&(l-=9),i+=l,F=!F}n=i%10===0}return _showValidateMsg(a,e,n)}function _fnValidIpv4(a,e){var t=$(a).val(),n=0===t.length;n||(n=/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$/i.test(t)&&_.every(t.split("."),function(a){return a.length>1?!a.beginsWith("0"):!0})),_showValidateMsg(a,e,n)}function _fnValidIpv6(a,e){var t=$(a).val(),n=0===t.length;n||(n=/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i.test(t)),_showValidateMsg(a,e,n)}function _fnValidIpAddress(a,e){var t=$(a).val(),n=0===t.length;if(!n){var i=t,l=klib.toInt($(a).data("validateIpaddressOctates")||4)-1,F=new RegExp("^(([01]?[0-9]?[0-9]|2([0-4][0-9]|5[0-5]))\\.){"+l+"}([01]?[0-9]?[0-9]|2([0-4][0-9]|5[0-5]))$","g");n=F.test(i)&&_.every(i.split("."),function(a){return a.length>1?!a.beginsWith("0"):!0}),_showValidateMsg(a,e,n);var u=$(a).data("validateIpaddressClass");if(n&&u){var d=i.split("."),r={A:{oct1:{B:0,E:127},oct2:{B:0,E:256},oct3:{B:0,E:256},oct4:{B:1,E:255}},B:{oct1:{B:127,E:192},oct2:{B:1,E:256},oct3:{B:0,E:256},oct4:{B:0,E:255}},C:{oct1:{B:191,E:224},oct2:{B:0,E:256},oct3:{B:1,E:256},oct4:{B:1,E:255}},D:{oct1:{B:223,E:240},oct2:{B:0,E:256},oct3:{B:0,E:256},oct4:{B:0,E:256}},E:{oct1:{B:239,E:255},oct2:{B:0,E:256},oct3:{B:0,E:256},oct4:{B:0,E:255}}};n=1*d[0]>r[u].oct1.B&&1*d[0]<r[u].oct1.E&&1*d[1]>=r[u].oct2.B&&1*d[1]<r[u].oct2.E&&1*d[2]>=r[u].oct3.B&&1*d[2]<r[u].oct3.E&&1*d[3]>r[u].oct4.B&&1*d[3]<r[u].oct4.E?!0:!1,_showValidateMsg(a,e,n)}}return n}function _fnValidSubnet(a,e){var t=$(a).val(),n=0===t.length;if(!n){var i=new RegExp("^((128|192|224|240|248|252|254)\\.0\\.0\\.0)|(255\\.(((0|128|192|224|240|248|252|254)\\.0\\.0)|(255\\.(((0|128|192|224|240|248|252|254)\\.0)|255\\.(0|128|192|224|240|248|252|254)))))$");n=i.test(t)&&_.every(t.split("."),function(a){return a.length>1?!a.beginsWith("0"):!0})}return _showValidateMsg(a,e,n)}function _fnValidPhoneUS(a,e){var t=$(a).val(),n=0===t.length;return n||(n=t.length>9&&t.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)),_showValidateMsg(a,e,n)}function _showValidateMsg(a,e,t,n){e=e||"",arguments.length>2&&_.isString(t)&&(n=t),arguments.length>2&&_.isBoolean(t)&&t&&(e=""),n=n||_validateAlertTemplate,a=$($(a).data("validateMsgEl")||a).get(0);var i=$(a).next(),l="";if($(i).attr("class")===$(n).attr("class")){if(e.beginsWith("i18n:","i")){var F=e.replace(/i18n:/gi,"");l="{html:'"+F+"'}",e=$.i18n.prop(F)}_isOnOfflineValidation||($(i).data("i18n",l),$(i).html(e))}else klib.isBlank(e)||($(n).insertAfter($(a)),_showValidateMsg(a,e,t,n));return t}function _clearValidateMsg(a){return _showValidateMsg(a),!0}var _isOnOfflineValidation,_validateAlertTemplate='<div class="errortxt break-txt" data-i18n=""></div>',_check={required:_fnRequired,digits:_fnValidDigits,numbers:_fnValidNumbers,integer:_fnValidInteger,alphabet:_fnValidAlpha,alphanumeric:_fnValidAlphaNumeric,pattern:_fnValidPatternMatch,range:_fnValidValueRange,fixedlength:_fnValidLengths,minlength:_fnValidLengthMin,maxlength:_fnValidLengthMax,email:_fnValidEmail,url:_fnValidUrl,date:_isValidDate,cardno:_fnValidCardNo,ipv4:_fnValidIpv4,ipv6:_fnValidIpv6,ipaddress:_fnValidIpAddress,subnetmask:_fnValidSubnet,phoneUS:_fnValidPhoneUS,wordsize:_fnValidWordSize},_offlineValidationRules={};klib.initDataValidation=function(a){var e=function(a){return a=a||{},_.each(_.keys(a),function(e){e.indexOf("_")>0&&(_.each(e.split("_"),function(t){a[t]?_.isArray(a[t])?a[t].push(a[e]):a[t]=[a[t],a[e]]:a[t]=[a[e]]}),delete a[e])}),a};a=a||"body";var t=$(a),n=t.data("validateElFilter")||"",i=e(klib.toJSON(t.data("validateCommon")||"{}"));klib.console.log(_.keys(i));var l,F,u,d,r,o=t.data("offlineValidationStoreKey")||"",s=!klib.isBlank(o);s&&(_offlineValidationRules[o]={rules:{}}),t.find(n+"[data-validate]").each(function(a,t){var n=$(t).prop("id"),f={},g=$(t).data("validate");if(g&&g.indexOf("{")<0){var c=($(t).data("validateEvents")||"onBlur").replace(/[^a-z]/gi," ").normalizeStr().replace(/ /g,"_"),v=",offline:"+($(t).data("validateOffline")||"false"),h="{fn:"+g.replace(/[,;]/," ").normalizeStr().replace(/ /g,v+"},{fn:")+v+"}";g="{"+c+":["+h+"]}"}f=e(klib.toJSON(g)),klib.console.log(g),_.each(_.keys(i),function(a){var e=i[a];_.isArray(e)||(e=[e]),_.each(e,function(e){if(l=!0,F="<",d=e.offline||!1,u=!1,e.el){var t=e.el.replace(/ /g,"").split(","),i=e.el.replace(/[< >!]/g,"").split(","),o=_.indexOf(i,n);l=o>=0,l&&(F=t[o].indexOf(">")>=0?">":"<",u=t[o].indexOf("!")>=0)}else e.ex&&(l=_.indexOf(e.ex.replace(/[< >!]/g,"").split(","),n)<0);l&&(r=_.omit(e,["el","ex"]),u&&(r=_.extend(r,{offline:!d})),f[a]||(f[a]=[]),f[a]="<"===F?_.union([r],f[a]):_.union(f[a],[r]))})}),_.each(_.keys(f),function(a){var e=a.substring(2,3).toLowerCase()+a.substring(3);klib.console.log("settingup event on["+e+"]..."),_.isArray(f[a])||(f[a]=[f[a]]),s&&_.each(f[a],function(a){a.offline&&(_offlineValidationRules[o].rules[n]||(_offlineValidationRules[o].rules[n]=[]),_.indexOf(_offlineValidationRules[o].rules[n],a.fn)<0&&_offlineValidationRules[o].rules[n].push(a.fn))}),$(t).on(e,function(){_.every(f[a],function(a){return _.isArray(a)?_.every(a,function(a){return a.fn(t,a.msg||$(t).data("validateMsg")||"")}):a.fn(t,a.msg||$(t).data("validateMsg")||"")})})})})},klib.doDataValidation=function(a){var e=a.replace(/#/g,""),t="#"+e,n=$(t),i={};if(_offlineValidationRules[e]){var l=_offlineValidationRules[e].rules,F=function(a){var e=n.find("#"+a),t=klib.toBoolean(e.data("ignoreValidationIfInvisible"))&&!e.is(":visible");return t||(t=_.every(l[a],function(a){var t=a(e);return t||(i={errcode:2,el:e,fn:a}),t})),t};if($.isEmptyObject(l))i={errcode:1,errmsg:"Rules not found in scope ["+a+"]."};else{_isOnOfflineValidation=!0;_.every(_.keys(l),function(a){return F(a)});_isOnOfflineValidation=!1}}else i={errcode:1,errmsg:"Scope not found."};return i};